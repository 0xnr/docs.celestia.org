<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Data Structures | Celestia Documentation</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/github-markdown-css/2.2.1/github-markdown.css">
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.81866bf9.css" as="style"><link rel="preload" href="/assets/js/app.3019ee2f.js" as="script"><link rel="preload" href="/assets/js/24.9ee132fe.js" as="script"><link rel="preload" href="/assets/js/21.865da597.js" as="script"><link rel="preload" href="/assets/js/19.9237c15e.js" as="script"><link rel="preload" href="/assets/js/25.d7d7cb83.js" as="script"><link rel="preload" href="/assets/js/51.3dad154c.js" as="script"><link rel="preload" href="/assets/js/35.41cfeeaf.js" as="script"><link rel="preload" href="/assets/js/10.52df64e7.js" as="script"><link rel="preload" href="/assets/js/7.ab024a49.js" as="script"><link rel="preload" href="/assets/js/2.8fa296b0.js" as="script"><link rel="preload" href="/assets/js/3.99b12bb4.js" as="script"><link rel="preload" href="/assets/js/5.ba54e65b.js" as="script"><link rel="preload" href="/assets/js/33.bfc83eac.js" as="script"><link rel="preload" href="/assets/js/13.730058d7.js" as="script"><link rel="preload" href="/assets/js/12.87efa0ff.js" as="script"><link rel="preload" href="/assets/js/20.bbf83c6f.js" as="script"><link rel="prefetch" href="/assets/js/11.9d108668.js"><link rel="prefetch" href="/assets/js/14.8d4f0c49.js"><link rel="prefetch" href="/assets/js/15.ae1ada4a.js"><link rel="prefetch" href="/assets/js/16.1b24197e.js"><link rel="prefetch" href="/assets/js/17.f16d7c5b.js"><link rel="prefetch" href="/assets/js/18.942095fc.js"><link rel="prefetch" href="/assets/js/22.ad51f1c3.js"><link rel="prefetch" href="/assets/js/23.9e0e06ff.js"><link rel="prefetch" href="/assets/js/26.7e82fea6.js"><link rel="prefetch" href="/assets/js/27.a1e02d71.js"><link rel="prefetch" href="/assets/js/28.aa2ef353.js"><link rel="prefetch" href="/assets/js/29.9ae8b841.js"><link rel="prefetch" href="/assets/js/30.5a709172.js"><link rel="prefetch" href="/assets/js/31.34c68dc8.js"><link rel="prefetch" href="/assets/js/32.d42c463e.js"><link rel="prefetch" href="/assets/js/34.2cd18a16.js"><link rel="prefetch" href="/assets/js/36.cfc4be42.js"><link rel="prefetch" href="/assets/js/37.e0c56669.js"><link rel="prefetch" href="/assets/js/38.182458fa.js"><link rel="prefetch" href="/assets/js/39.9e9a83ca.js"><link rel="prefetch" href="/assets/js/4.bea0ca1f.js"><link rel="prefetch" href="/assets/js/40.b851cdf5.js"><link rel="prefetch" href="/assets/js/41.ad2eed03.js"><link rel="prefetch" href="/assets/js/42.5b62ade6.js"><link rel="prefetch" href="/assets/js/43.609c0d9e.js"><link rel="prefetch" href="/assets/js/44.835b1409.js"><link rel="prefetch" href="/assets/js/45.fa1acad7.js"><link rel="prefetch" href="/assets/js/46.2b224627.js"><link rel="prefetch" href="/assets/js/47.1381eb90.js"><link rel="prefetch" href="/assets/js/48.6a431235.js"><link rel="prefetch" href="/assets/js/49.5e6591aa.js"><link rel="prefetch" href="/assets/js/50.627e396f.js"><link rel="prefetch" href="/assets/js/52.21fb84fb.js"><link rel="prefetch" href="/assets/js/53.68701b3d.js"><link rel="prefetch" href="/assets/js/54.5787652b.js"><link rel="prefetch" href="/assets/js/55.5f54644b.js"><link rel="prefetch" href="/assets/js/56.4abb7414.js"><link rel="prefetch" href="/assets/js/57.4f876269.js"><link rel="prefetch" href="/assets/js/58.f5c5b703.js"><link rel="prefetch" href="/assets/js/59.8fba7a76.js"><link rel="prefetch" href="/assets/js/6.d536bb7f.js"><link rel="prefetch" href="/assets/js/60.5168e751.js"><link rel="prefetch" href="/assets/js/61.a6501cdb.js"><link rel="prefetch" href="/assets/js/62.fd362acf.js"><link rel="prefetch" href="/assets/js/63.1a9e837a.js"><link rel="prefetch" href="/assets/js/64.bd0922fd.js"><link rel="prefetch" href="/assets/js/65.c711a466.js"><link rel="prefetch" href="/assets/js/66.a75565f2.js"><link rel="prefetch" href="/assets/js/67.99c98f3c.js"><link rel="prefetch" href="/assets/js/68.d804f7bc.js"><link rel="prefetch" href="/assets/js/69.31c3af29.js"><link rel="prefetch" href="/assets/js/70.807ee0c3.js"><link rel="prefetch" href="/assets/js/71.b636387e.js"><link rel="prefetch" href="/assets/js/72.136a17fc.js"><link rel="prefetch" href="/assets/js/73.0aab1a53.js"><link rel="prefetch" href="/assets/js/74.6d9a22b7.js"><link rel="prefetch" href="/assets/js/8.cb4ef797.js"><link rel="prefetch" href="/assets/js/9.e62193ab.js">
    <link rel="stylesheet" href="/assets/css/0.styles.81866bf9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div data-v-58560e81><div data-v-40401285 data-v-58560e81><div class="banner-wrapper" data-v-40401285 data-v-40401285><div class="wrapper" data-v-40401285><div class="message" data-v-40401285>By using this website, you agree to our <a href="https://www.cookiesandyou.com" target="_blank" rel="noopener" style="color:#505FFF;" data-v-40401285>Cookie Policy</a>.</div> <div class="box" data-v-40401285><span class="icon-cross" data-v-40401285><svg width="16" height="16" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-40401285><path d="M1.66669 1.66669L12.3334 12.3334M12.3334 1.66669L1.66664 12.3334" stroke="#A2A3AD" stroke-width="1.5" stroke-linecap="round" data-v-40401285></path></svg></span></div></div></div></div><!----><div class="layout" data-v-58560e81><div class="layout__sidebar" data-v-58560e81><div style="height:100%;position:relative;" data-v-ab16c0b6 data-v-58560e81><div class="container" data-v-ab16c0b6><a href="/" class="logo__container router-link-active" data-v-ab16c0b6><div class="logo" data-v-ab16c0b6><div class="logo__img__custom" data-v-ab16c0b6><img src="/celestia_docs_purple.svg" data-v-ab16c0b6></div><!----></div></a><div class="items footer__compact__false" data-v-ab16c0b6><div class="sidebar" style="display:none;" data-v-ab16c0b6><div class="title" data-v-ab16c0b6></div><!----></div><div class="sidebar" style="display:block;" data-v-ab16c0b6><div class="title" data-v-ab16c0b6>Documentation</div><!----></div><div class="sidebar version" data-v-ab16c0b6><div data-v-08503e1b data-v-ab16c0b6><div class="container" data-v-08503e1b><span class="sr-only" data-v-08503e1b>Docs Version Switcher</span><div class="select" data-v-08503e1b><select data-v-08503e1b><option value="" disabled="disabled" data-v-08503e1b>Version</option><option value="main" data-v-08503e1b>main</option><option value="v0.5" data-v-08503e1b>v0.5</option></select></div></div></div></div></div><!----></div></div></div><div class="layout__main" data-v-58560e81><div class="layout__main__navbar" data-v-58560e81><div data-v-19189c02 data-v-58560e81><div class="container" data-v-19189c02><div class="menu" data-v-19189c02><div class="menu__icon" data-v-19189c02><svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="#888" data-v-19189c02><path d="M2 5H22M2 12H22M2 19H22" stroke-width="1.5" stroke-linecap="round"></path></svg></div></div><div class="logo" data-v-19189c02><div class="logo__wrapper router-link-active" data-v-19189c02><div class="logo__image__custom" data-v-19189c02><img src="/celestia_docs_purple.svg" class="logo__image__custom__img" data-v-19189c02></div><!----></div></div><div class="toolbar" data-v-19189c02><div class="toolbar__item" data-v-19189c02><div class="toolbar__item__icon" data-v-19189c02><svg width="100%" height="100%" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="#888" data-v-19189c02><path fill-rule="evenodd" clip-rule="evenodd" d="M11.5 2.75C6.66751 2.75 2.75 6.66751 2.75 11.5C2.75 16.3325 6.66751 20.25 11.5 20.25C13.6462 20.25 15.612 19.4773 17.1342 18.1949L22.6697 23.7303C22.9626 24.0232 23.4374 24.0232 23.7303 23.7303C24.0232 23.4374 24.0232 22.9626 23.7303 22.6697L18.1949 17.1342C19.4773 15.612 20.25 13.6462 20.25 11.5C20.25 6.66751 16.3325 2.75 11.5 2.75ZM16.6923 16.5599C17.9656 15.2535 18.75 13.4684 18.75 11.5C18.75 7.49594 15.5041 4.25 11.5 4.25C7.49594 4.25 4.25 7.49594 4.25 11.5C4.25 15.5041 7.49594 18.75 11.5 18.75C13.4684 18.75 15.2535 17.9656 16.5599 16.6923C16.5789 16.6679 16.5996 16.6444 16.622 16.622C16.6444 16.5996 16.6679 16.5789 16.6923 16.5599Z"></path></svg></div></div></div></div></div></div><div class="layout__main__content aside__true" data-v-58560e81><div id="content-scroll" class="layout__main__content__body" data-v-58560e81><div class="layout__main__content__body__breadcrumbs" data-v-58560e81><div data-v-48fb2d7a data-v-58560e81><div class="container" data-v-48fb2d7a><div class="crumbs" data-v-48fb2d7a><a href="/" class="crumbs__item router-link-active" data-v-48fb2d7a>Celestia Documentation</a><a href="/specs/data_structures.html" aria-current="page" class="crumbs__item router-link-exact-active router-link-active" data-v-48fb2d7a>specs</a><a href="/specs/data_structures.html" aria-current="page" class="crumbs__item router-link-exact-active router-link-active" data-v-48fb2d7a>Data Structures</a></div><div class="menu" data-v-48fb2d7a><div class="menu__item" style="visibility:visible;" data-v-48fb2d7a><svg width="100%" height="100%" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="menu__item__icon menu__item__icon__active__false" data-v-48fb2d7a><path fill-rule="evenodd" clip-rule="evenodd" d="M0.25 2C0.25 1.58579 0.585786 1.25 1 1.25H6C6.41421 1.25 6.75 1.58579 6.75 2C6.75 2.41421 6.41421 2.75 6 2.75H1C0.585786 2.75 0.25 2.41421 0.25 2ZM17.53 22.7803L16.9997 22.25L17.53 22.7803L17.5301 22.7802L17.5305 22.7798L17.5322 22.7781L17.5388 22.7715L17.5647 22.7456L17.6647 22.6456L18.0367 22.2737L19.2978 21.0126L22.53 17.7803C22.8229 17.4874 22.8229 17.0126 22.53 16.7197C22.2371 16.4268 21.7622 16.4268 21.4693 16.7197L18.2371 19.9519L17.7497 20.4393V8.5C17.7497 6.34186 17.0721 4.51182 15.7802 3.21983C14.4882 1.92783 12.6581 1.25031 10.5 1.25031C10.0858 1.25031 9.75 1.5861 9.75 2.00031C9.75 2.41453 10.0858 2.75031 10.5 2.75031C12.3419 2.75031 13.7617 3.32264 14.7195 4.28049C15.6773 5.23834 16.2497 6.65814 16.2497 8.5L16.2497 20.4393L12.53 16.7197C12.2371 16.4268 11.7622 16.4268 11.4693 16.7197C11.1764 17.0126 11.1764 17.4874 11.4693 17.7803L16.4693 22.7803L16.9997 23.3107L17.53 22.7803ZM1 6.25C0.585786 6.25 0.25 6.58579 0.25 7C0.25 7.41421 0.585786 7.75 1 7.75H10C10.4142 7.75 10.75 7.41421 10.75 7C10.75 6.58579 10.4142 6.25 10 6.25H1ZM0.25 12C0.25 11.5858 0.585786 11.25 1 11.25H12C12.4142 11.25 12.75 11.5858 12.75 12C12.75 12.4142 12.4142 12.75 12 12.75H1C0.585786 12.75 0.25 12.4142 0.25 12ZM1 16.25C0.585786 16.25 0.25 16.5858 0.25 17C0.25 17.4142 0.585786 17.75 1 17.75H8C8.41421 17.75 8.75 17.4142 8.75 17C8.75 16.5858 8.41421 16.25 8 16.25H1Z" data-v-48fb2d7a></path></svg><!----></div></div></div></div></div><div class="layout__main__content__body__wrapper" data-v-58560e81><div style="width:100%;" data-v-c85ed208 data-v-58560e81><div class="search__container" data-v-c85ed208><div class="search" data-v-c85ed208><div class="search__icon" data-v-c85ed208><svg width="100%" height="100%" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-v-c85ed208><path fill-rule="evenodd" clip-rule="evenodd" d="M11.5 2.75C6.66751 2.75 2.75 6.66751 2.75 11.5C2.75 16.3325 6.66751 20.25 11.5 20.25C13.6462 20.25 15.612 19.4773 17.1342 18.1949L22.6697 23.7303C22.9626 24.0232 23.4374 24.0232 23.7303 23.7303C24.0232 23.4374 24.0232 22.9626 23.7303 22.6697L18.1949 17.1342C19.4773 15.612 20.25 13.6462 20.25 11.5C20.25 6.66751 16.3325 2.75 11.5 2.75ZM16.6923 16.5599C17.9656 15.2535 18.75 13.4684 18.75 11.5C18.75 7.49594 15.5041 4.25 11.5 4.25C7.49594 4.25 4.25 7.49594 4.25 11.5C4.25 15.5041 7.49594 18.75 11.5 18.75C13.4684 18.75 15.2535 17.9656 16.5599 16.6923C16.5789 16.6679 16.5996 16.6444 16.622 16.622C16.6444 16.5996 16.6679 16.5789 16.6923 16.5599Z"></path></svg></div><div class="search__text" data-v-c85ed208>Search</div></div></div><div class="container" data-v-c85ed208><div class="content__default" data-v-58560e81><h1 id="data-structures"><a href="#data-structures" class="header-anchor">#</a> Data Structures</h1> <ul><li><a href="#data-structures-overview">Data Structures Overview</a></li> <li><a href="#type-aliases">Type Aliases</a></li> <li><a href="#blockchain-data-structures">Blockchain Data Structures</a> <ul><li><a href="#block">Block</a></li> <li><a href="#header">Header</a></li> <li><a href="#availabledataheader">AvailableDataHeader</a></li> <li><a href="#availabledata">AvailableData</a></li> <li><a href="#commit">Commit</a></li> <li><a href="#timestamp">Timestamp</a></li> <li><a href="#hashdigest">HashDigest</a></li> <li><a href="#transactionfee">TransactionFee</a></li> <li><a href="#address">Address</a></li> <li><a href="#commitsig">CommitSig</a></li> <li><a href="#signature">Signature</a></li></ul></li> <li><a href="#consensusversion">ConsensusVersion</a></li> <li><a href="#serialization">Serialization</a></li> <li><a href="#hashing">Hashing</a></li> <li><a href="#public-key-cryptography">Public-Key Cryptography</a></li> <li><a href="#merkle-trees">Merkle Trees</a> <ul><li><a href="#binary-merkle-tree">Binary Merkle Tree</a> <ul><li><a href="#binarymerkletreeinclusionproof">BinaryMerkleTreeInclusionProof</a></li></ul></li> <li><a href="#namespace-merkle-tree">Namespace Merkle Tree</a> <ul><li><a href="#namespacemerkletreeinclusionproof">NamespaceMerkleTreeInclusionProof</a></li></ul></li> <li><a href="#sparse-merkle-tree">Sparse Merkle Tree</a> <ul><li><a href="#sparsemerkletreeinclusionproof">SparseMerkleTreeInclusionProof</a></li></ul></li></ul></li> <li><a href="#erasure-coding">Erasure Coding</a> <ul><li><a href="#reed-solomon-erasure-coding">Reed-Solomon Erasure Coding</a></li> <li><a href="#2d-reed-solomon-encoding-scheme">2D Reed-Solomon Encoding Scheme</a></li> <li><a href="#share">Share</a></li> <li><a href="#arranging-available-data-into-shares">Arranging Available Data Into Shares</a></li></ul></li> <li><a href="#available-data">Available Data</a> <ul><li><a href="#transactiondata">TransactionData</a> <ul><li><a href="#wrappedtransaction">WrappedTransaction</a></li> <li><a href="#transaction">Transaction</a></li> <li><a href="#signedtransactiondata">SignedTransactionData</a> <ul><li><a href="#signedtransactiondatatransfer">SignedTransactionDataTransfer</a></li> <li><a href="#signedtransactiondatapayformessage">SignedTransactionDataPayForMessage</a></li> <li><a href="#signedtransactiondatacreatevalidator">SignedTransactionDataCreateValidator</a></li> <li><a href="#signedtransactiondatabeginunbondingvalidator">SignedTransactionDataBeginUnbondingValidator</a></li> <li><a href="#signedtransactiondataunbondvalidator">SignedTransactionDataUnbondValidator</a></li> <li><a href="#signedtransactiondatacreatedelegation">SignedTransactionDataCreateDelegation</a></li> <li><a href="#signedtransactiondatabeginunbondingdelegation">SignedTransactionDataBeginUnbondingDelegation</a></li> <li><a href="#signedtransactiondataunbonddelegation">SignedTransactionDataUnbondDelegation</a></li> <li><a href="#signedtransactiondataburn">SignedTransactionDataBurn</a></li> <li><a href="#signedtransactionredelegatecommission">SignedTransactionRedelegateCommission</a></li> <li><a href="#signedtransactionredelegatereward">SignedTransactionRedelegateReward</a></li></ul></li></ul></li> <li><a href="#intermediatestaterootdata">IntermediateStateRootData</a> <ul><li><a href="#wrappedintermediatestateroot">WrappedIntermediateStateRoot</a></li> <li><a href="#intermediatestateroot">IntermediateStateRoot</a></li></ul></li> <li><a href="#evidencedata">EvidenceData</a> <ul><li><a href="#evidence">Evidence</a></li> <li><a href="#publickey">PublicKey</a></li> <li><a href="#vote">Vote</a></li></ul></li> <li><a href="#messagedata">MessageData</a> <ul><li><a href="#message">Message</a></li></ul></li></ul></li> <li><a href="#state">State</a> <ul><li><a href="#stateelement">StateElement</a></li> <li><a href="#account">Account</a></li> <li><a href="#delegation">Delegation</a></li> <li><a href="#validator">Validator</a></li> <li><a href="#activevalidatorcount">ActiveValidatorCount</a></li> <li><a href="#activevotingpower">ActiveVotingPower</a></li> <li><a href="#proposerblockreward">ProposerBlockReward</a></li> <li><a href="#proposerinitialvotingpower">ProposerInitialVotingPower</a></li> <li><a href="#validatorqueuehead">ValidatorQueueHead</a></li> <li><a href="#periodentry">PeriodEntry</a></li> <li><a href="#decimal">Decimal</a></li> <li><a href="#messagepaid">MessagePaid</a></li> <li><a href="#messagepaidhead">MessagePaidHead</a></li></ul></li> <li><a href="#consensus-parameters">Consensus Parameters</a></li></ul> <h2 id="data-structures-overview"><a href="#data-structures-overview" class="header-anchor">#</a> Data Structures Overview</h2> <p><img src="/assets/img/block_data_structures.989d19a7.svg" alt="fig: Block data structures."></p> <h2 id="type-aliases"><a href="#type-aliases" class="header-anchor">#</a> Type Aliases</h2> <table><thead><tr><th>name</th> <th>type</th></tr></thead> <tbody><tr><td><a href="#address"><code>Address</code></a></td> <td><code>byte[32]</code></td></tr> <tr><td><code>Amount</code></td> <td><code>uint64</code></td></tr> <tr><td><code>Graffiti</code></td> <td><code>byte[MAX_GRAFFITI_BYTES]</code></td></tr> <tr><td><a href="#hashdigest"><code>HashDigest</code></a></td> <td><code>byte[32]</code></td></tr> <tr><td><code>Height</code></td> <td><code>int64</code></td></tr> <tr><td><code>NamespaceID</code></td> <td><code>byte[NAMESPACE_ID_BYTES]</code></td></tr> <tr><td><code>Nonce</code></td> <td><code>uint64</code></td></tr> <tr><td><code>Round</code></td> <td><code>int32</code></td></tr> <tr><td><code>StateSubtreeID</code></td> <td><code>byte</code></td></tr> <tr><td><a href="#timestamp"><code>Timestamp</code></a></td> <td><code>google.protobuf.Timestamp</code></td></tr> <tr><td><code>VotingPower</code></td> <td><code>uint64</code></td></tr></tbody></table> <h2 id="blockchain-data-structures"><a href="#blockchain-data-structures" class="header-anchor">#</a> Blockchain Data Structures</h2> <h3 id="block"><a href="#block" class="header-anchor">#</a> Block</h3> <p>Blocks are the top-level data structure of the Celestia blockchain.</p> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>header</code></td> <td><a href="#header">Header</a></td> <td>Block header. Contains primarily identification info and commitments.</td></tr> <tr><td><code>availableDataHeader</code></td> <td><a href="#availabledataheader">AvailableDataHeader</a></td> <td>Header of available data. Contains commitments to erasure-coded data.</td></tr> <tr><td><code>availableData</code></td> <td><a href="#availabledata">AvailableData</a></td> <td>Data that is erasure-coded for availability.</td></tr> <tr><td><code>lastCommit</code></td> <td><a href="#commit">Commit</a></td> <td>Previous block's Tendermint commit.</td></tr></tbody></table> <h3 id="header"><a href="#header" class="header-anchor">#</a> Header</h3> <p>Block header, which is fully downloaded by both full clients and light clients.</p> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>version</code></td> <td><a href="#consensusversion">ConsensusVersion</a></td> <td>The consensus version struct.</td></tr> <tr><td><code>chainID</code></td> <td><code>string</code></td> <td>The <code>CHAIN_ID</code>.</td></tr> <tr><td><code>height</code></td> <td><a href="#type-aliases">Height</a></td> <td>Block height. The genesis block is at height <code>1</code>.</td></tr> <tr><td><code>timestamp</code></td> <td><a href="#timestamp">Timestamp</a></td> <td>Timestamp of this block.</td></tr> <tr><td><code>lastHeaderHash</code></td> <td><a href="#hashdigest">HashDigest</a></td> <td>Previous block's header hash.</td></tr> <tr><td><code>lastCommitHash</code></td> <td><a href="#hashdigest">HashDigest</a></td> <td>Previous block's Tendermint commit hash.</td></tr> <tr><td><code>consensusHash</code></td> <td><a href="#hashdigest">HashDigest</a></td> <td>Hash of <a href="#consensus-parameters">consensus parameters</a> for this block.</td></tr> <tr><td><code>stateCommitment</code></td> <td><a href="#hashdigest">HashDigest</a></td> <td>The <a href="#state">state root</a> after this block's transactions are applied.</td></tr> <tr><td><code>availableDataOriginalSharesUsed</code></td> <td><code>uint64</code></td> <td>The number of shares used in the <a href="#arranging-available-data-into-shares">original data square</a> that are not <a href="/specs/consensus.html#reserved-namespace-ids">tail padding</a>.</td></tr> <tr><td><code>availableDataRoot</code></td> <td><a href="#hashdigest">HashDigest</a></td> <td>Root of <a href="#availabledataheader">commitments to erasure-coded data</a>.</td></tr> <tr><td><code>proposerAddress</code></td> <td><a href="#address">Address</a></td> <td>Address of this block's proposer.</td></tr></tbody></table> <p>The size of the <a href="#arranging-available-data-into-shares">original data square</a>, <code>availableDataOriginalSquareSize</code>, isn't explicitly declared in the block header. Instead, it is implicitly computed as the smallest power of 2 whose square is at least <code>availableDataOriginalSharesUsed</code> (in other words, the smallest power of 4 that is at least <code>availableDataOriginalSharesUsed</code>).</p> <p>The header hash is the <a href="#hashing">hash</a> of the <a href="#serialization">serialized</a> header.</p> <h3 id="availabledataheader"><a href="#availabledataheader" class="header-anchor">#</a> AvailableDataHeader</h3> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>rowRoots</code></td> <td><a href="#hashdigest">HashDigest</a><code>[]</code></td> <td>Commitments to all erasure-coded data.</td></tr> <tr><td><code>colRoots</code></td> <td><a href="#hashdigest">HashDigest</a><code>[]</code></td> <td>Commitments to all erasure-coded data.</td></tr></tbody></table> <p>The number of row/column roots of the original data <a href="/specs/data_structures.html#share">shares</a> in <a href="#arranging-available-data-into-shares">square layout</a> for this block. The <code>availableDataRoot</code> of the <a href="#header">header</a> is computed using the compact row and column roots as described <a href="#2d-reed-solomon-encoding-scheme">here</a>.</p> <p>The number of row and column roots is each <code>availableDataOriginalSquareSize * 2</code>, and must be a power of 2. Note that the minimum <code>availableDataOriginalSquareSize</code> is 1 (not 0), therefore the number of row and column roots are each at least 2.</p> <p>Implementations can prune rows containing only <a href="/specs/consensus.html#reserved-namespace-ids">tail padding</a> as they are implicitly available.</p> <h3 id="availabledata"><a href="#availabledata" class="header-anchor">#</a> AvailableData</h3> <p>Data that is <a href="#erasure-coding">erasure-coded</a> for <a href="https://arxiv.org/abs/1809.09044" target="_blank" rel="noopener noreferrer">data availability checks<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>transactionData</code></td> <td><a href="#transactiondata">TransactionData</a></td> <td>Transaction data. Transactions modify the validator set and balances, and pay fees for messages to be included.</td></tr> <tr><td><code>intermediateStateRootData</code></td> <td><a href="#intermediatestaterootdata">IntermediateStateRootData</a></td> <td>Intermediate state roots used for fraud proofs.</td></tr> <tr><td><code>evidenceData</code></td> <td><a href="#evidencedata">EvidenceData</a></td> <td>Evidence used for slashing conditions (e.g. equivocation).</td></tr> <tr><td><code>messageData</code></td> <td><a href="#messagedata">MessageData</a></td> <td>Message data. Messages are app data.</td></tr></tbody></table> <h3 id="commit"><a href="#commit" class="header-anchor">#</a> Commit</h3> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>height</code></td> <td><a href="#type-aliases">Height</a></td> <td>Block height.</td></tr> <tr><td><code>round</code></td> <td><a href="#type-aliases">Round</a></td> <td>Round. Incremented on view change.</td></tr> <tr><td><code>headerHash</code></td> <td><a href="#hashdigest">HashDigest</a></td> <td>Header hash of the previous block.</td></tr> <tr><td><code>signatures</code></td> <td><a href="#commitsig">CommitSig</a><code>[]</code></td> <td>List of signatures.</td></tr></tbody></table> <h3 id="timestamp"><a href="#timestamp" class="header-anchor">#</a> Timestamp</h3> <p>Timestamp is a <a href="#type-aliases">type alias</a>.</p> <p>Celestia uses <a href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#google.protobuf.Timestamp" target="_blank" rel="noopener noreferrer"><code>google.protobuf.Timestamp</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to represent time.</p> <h3 id="hashdigest"><a href="#hashdigest" class="header-anchor">#</a> HashDigest</h3> <p>HashDigest is a <a href="#type-aliases">type alias</a>.</p> <p>Output of the <a href="#hashing">hashing</a> function. Exactly 256 bits (32 bytes) long.</p> <h3 id="transactionfee"><a href="#transactionfee" class="header-anchor">#</a> TransactionFee</h3> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>tipRate</code></td> <td><code>uint64</code></td> <td>The tip rate for this transaction.</td></tr></tbody></table> <p>Abstraction over transaction fees.</p> <h3 id="address"><a href="#address" class="header-anchor">#</a> Address</h3> <p>Address is a <a href="#type-aliases">type alias</a>.</p> <p>Addresses are the <a href="#hashing">hash</a> <a href="#hashdigest">digest</a> of the <a href="#publickey">public key</a>.</p> <p>Addresses have a length of 32 bytes.</p> <h3 id="commitsig"><a href="#commitsig" class="header-anchor">#</a> CommitSig</h3> <span class="codeblock" data-v-1eda75b2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-1eda75b2><span class="body__container" data-v-1eda75b2><span class="body__block" data-v-1eda75b2><span class="icons" data-v-1eda75b2><!----> <span class="icons__item" data-v-1eda75b2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-1eda75b2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-1eda75b2></path></svg> <span class="icons__item__tooltip" data-v-1eda75b2>
              Copy
            </span></span></span> <span class="body" data-v-1eda75b2><span class="body__wrapper" data-v-1eda75b2><span class="body__code" data-v-1eda75b2>enum CommitFlag : uint8_t {
    CommitFlagAbsent = 1,
    CommitFlagCommit = 2,
    CommitFlagNil = 3,
};
</span></span></span></span> <!----></span> <!----></span></span> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>commitFlag</code></td> <td><code>CommitFlag</code></td> <td></td></tr> <tr><td><code>validatorAddress</code></td> <td><a href="#address">Address</a></td> <td></td></tr> <tr><td><code>timestamp</code></td> <td><a href="#timestamp">Timestamp</a></td> <td></td></tr> <tr><td><code>signature</code></td> <td><a href="#signature">Signature</a></td> <td></td></tr></tbody></table> <h3 id="signature"><a href="#signature" class="header-anchor">#</a> Signature</h3> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>r</code></td> <td><code>byte[32]</code></td> <td><code>r</code> value of the signature.</td></tr> <tr><td><code>vs</code></td> <td><code>byte[32]</code></td> <td>1-bit <code>v</code> value followed by last 255 bits of <code>s</code> value of signature.</td></tr></tbody></table> <p>Output of the <a href="#public-key-cryptography">signing</a> process.</p> <h2 id="consensusversion"><a href="#consensusversion" class="header-anchor">#</a> ConsensusVersion</h2> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>block</code></td> <td><code>uint64</code></td> <td>The <code>VERSION_BLOCK</code>.</td></tr> <tr><td><code>app</code></td> <td><code>uint64</code></td> <td>The <code>VERSION_APP</code>.</td></tr></tbody></table> <h2 id="serialization"><a href="#serialization" class="header-anchor">#</a> Serialization</h2> <p>Objects that are committed to or signed over require a canonical serialization. This is done using a deterministic (and thus, bijective) variant of protobuf defined <a href="https://github.com/cosmos/cosmos-sdk/blob/master/docs/architecture/adr-027-deterministic-protobuf-serialization.md" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Note: there are two requirements for a serialization scheme, should this need to be changed:</p> <ol><li>Must be bijective.</li> <li>Serialization must include the length of dynamic structures (e.g. arrays with variable length).</li></ol> <h2 id="hashing"><a href="#hashing" class="header-anchor">#</a> Hashing</h2> <p>All protocol-level hashing is done using SHA-2-256 as defined in <a href="https://doi.org/10.6028/NIST.FIPS.180-4" target="_blank" rel="noopener noreferrer">FIPS 180-4<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. SHA-2-256 outputs a digest that is 256 bits (i.e. 32 bytes) long.</p> <p>Libraries implementing SHA-2-256 are available in Go (<a href="https://pkg.go.dev/crypto/sha256" target="_blank" rel="noopener noreferrer">https://pkg.go.dev/crypto/sha256<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>) and Rust (<a href="https://docs.rs/sha2" target="_blank" rel="noopener noreferrer">https://docs.rs/sha2<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>).</p> <p>Unless otherwise indicated explicitly, objects are first <a href="#serialization">serialized</a> before being hashed.</p> <h2 id="public-key-cryptography"><a href="#public-key-cryptography" class="header-anchor">#</a> Public-Key Cryptography</h2> <p>Consensus-critical data is authenticated using <a href="https://www.secg.org/sec1-v2.pdf" target="_blank" rel="noopener noreferrer">ECDSA<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, with the curve <a href="https://en.bitcoin.it/wiki/Secp256k1" target="_blank" rel="noopener noreferrer">secp256k1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. A highly-optimized library is available in C (<a href="https://github.com/bitcoin-core/secp256k1" target="_blank" rel="noopener noreferrer">https://github.com/bitcoin-core/secp256k1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>), with wrappers in Go (<a href="https://pkg.go.dev/github.com/ethereum/go-ethereum/crypto/secp256k1" target="_blank" rel="noopener noreferrer">https://pkg.go.dev/github.com/ethereum/go-ethereum/crypto/secp256k1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>) and Rust (<a href="https://docs.rs/crate/secp256k1" target="_blank" rel="noopener noreferrer">https://docs.rs/crate/secp256k1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>).</p> <p><a href="#publickey">Public keys</a> are encoded in uncompressed form, as the concatenation of the <code>x</code> and <code>y</code> values. No prefix is needed to distinguish between encoding schemes as this is the only encoding supported.</p> <p>Deterministic signatures (<a href="https://tools.ietf.org/rfc/rfc6979.txt" target="_blank" rel="noopener noreferrer">RFC-6979<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>) should be used when signing, but this is not enforced at the protocol level as it cannot be.</p> <p><a href="#signature">Signatures</a> are represented as the <code>r</code> and <code>s</code> (each 32 bytes), and <code>v</code> (1-bit) values of the signature. <code>r</code> and <code>s</code> take on their usual meaning (see: <a href="https://www.secg.org/sec1-v2.pdf" target="_blank" rel="noopener noreferrer">SEC 1, 4.1.3 Signing Operation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>), while <code>v</code> is used for recovering the public key from a signature more quickly (see: <a href="https://www.secg.org/sec1-v2.pdf" target="_blank" rel="noopener noreferrer">SEC 1, 4.1.6 Public Key Recovery Operation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>). Only low-<code>s</code> values in signatures are valid (i.e. <code>s &lt;= secp256k1.n//2</code>); <code>s</code> can be replaced with <code>-s mod secp256k1.n</code> during the signing process if it is high. Given this, the first bit of <code>s</code> will always be <code>0</code>, and can be used to store the 1-bit <code>v</code> value.</p> <p><code>v</code> represents the parity of the <code>Y</code> component of the point, <code>0</code> for even and <code>1</code> for odd. The <code>X</code> component of the point is assumed to always be low, since <a href="https://bitcoin.stackexchange.com/a/38909" target="_blank" rel="noopener noreferrer">the possibility of it being high is negligible<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Putting it all together, the encoding for signatures is:</p> <span class="codeblock" data-v-1eda75b2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-1eda75b2><span class="body__container" data-v-1eda75b2><span class="body__block" data-v-1eda75b2><span class="icons" data-v-1eda75b2><!----> <span class="icons__item" data-v-1eda75b2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-1eda75b2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-1eda75b2></path></svg> <span class="icons__item__tooltip" data-v-1eda75b2>
              Copy
            </span></span></span> <span class="body" data-v-1eda75b2><span class="body__wrapper" data-v-1eda75b2><span class="body__code" data-v-1eda75b2>|    32 bytes   ||           32 bytes           |
[256-bit r value][1-bit v value][255-bit s value]
</span></span></span></span> <!----></span> <!----></span></span> <p>This encoding scheme is derived from <a href="https://eips.ethereum.org/EIPS/eip-2098" target="_blank" rel="noopener noreferrer">EIP 2098: Compact Signature Representation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="merkle-trees"><a href="#merkle-trees" class="header-anchor">#</a> Merkle Trees</h2> <p>Merkle trees are used to authenticate various pieces of data across the Celestia stack, including transactions, messages, the validator set, etc. This section provides an overview of the different tree types used, and specifies how to construct them.</p> <h3 id="binary-merkle-tree"><a href="#binary-merkle-tree" class="header-anchor">#</a> Binary Merkle Tree</h3> <p>Binary Merkle trees are constructed in the same fashion as described in <a href="https://tools.ietf.org/html/rfc6962" target="_blank" rel="noopener noreferrer">Certificate Transparency (RFC-6962)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, except for using <a href="#hashing">a different hashing function</a>. Leaves are hashed once to get leaf node values and internal node values are the hash of the concatenation of their children (either leaf nodes or other internal nodes).</p> <p>Nodes contain a single field:</p> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>v</code></td> <td><a href="#hashdigest">HashDigest</a></td> <td>Node value.</td></tr></tbody></table> <p>The base case (an empty tree) is defined as the <a href="#hashing">hash</a> of the empty string:</p> <span class="codeblock" data-v-1eda75b2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-1eda75b2><span class="body__container" data-v-1eda75b2><span class="body__block" data-v-1eda75b2><span class="icons" data-v-1eda75b2><!----> <span class="icons__item" data-v-1eda75b2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-1eda75b2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-1eda75b2></path></svg> <span class="icons__item__tooltip" data-v-1eda75b2>
              Copy
            </span></span></span> <span class="body" data-v-1eda75b2><span class="body__wrapper" data-v-1eda75b2><span class="body__code" data-v-1eda75b2>node.v = 0xe3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
</span></span></span></span> <!----></span> <!----></span></span> <p>For leaf node <code>node</code> of leaf data <code>d</code>:</p> <span class="codeblock" data-v-1eda75b2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-1eda75b2><span class="body__container" data-v-1eda75b2><span class="body__block" data-v-1eda75b2><span class="icons" data-v-1eda75b2><!----> <span class="icons__item" data-v-1eda75b2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-1eda75b2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-1eda75b2></path></svg> <span class="icons__item__tooltip" data-v-1eda75b2>
              Copy
            </span></span></span> <span class="body" data-v-1eda75b2><span class="body__wrapper" data-v-1eda75b2><span class="body__code" data-v-1eda75b2>node.v = h(0x00, serialize(d))
</span></span></span></span> <!----></span> <!----></span></span> <p>For internal node <code>node</code> with children <code>l</code> and <code>r</code>:</p> <span class="codeblock" data-v-1eda75b2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-1eda75b2><span class="body__container" data-v-1eda75b2><span class="body__block" data-v-1eda75b2><span class="icons" data-v-1eda75b2><!----> <span class="icons__item" data-v-1eda75b2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-1eda75b2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-1eda75b2></path></svg> <span class="icons__item__tooltip" data-v-1eda75b2>
              Copy
            </span></span></span> <span class="body" data-v-1eda75b2><span class="body__wrapper" data-v-1eda75b2><span class="body__code" data-v-1eda75b2>node.v = h(0x01, l.v, r.v)
</span></span></span></span> <!----></span> <!----></span></span> <p>Note that rather than duplicating the last node if there are an odd number of nodes (the <a href="https://github.com/bitcoin/bitcoin/blob/5961b23898ee7c0af2626c46d5d70e80136578d3/src/consensus/merkle.cpp#L9-L43" target="_blank" rel="noopener noreferrer">Bitcoin design<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>), trees are allowed to be imbalanced. In other words, the height of each leaf may be different. For an example, see Section 2.1.3 of <a href="https://tools.ietf.org/html/rfc6962#section-2.1.3" target="_blank" rel="noopener noreferrer">Certificate Transparency (RFC-6962)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Leaves and internal nodes are hashed differently: the one-byte <code>0x00</code> is prepended for leaf nodes while <code>0x01</code> is prepended for internal nodes. This avoids a second-preimage attack <a href="https://en.wikipedia.org/wiki/Merkle_tree#Second_preimage_attack" target="_blank" rel="noopener noreferrer">where internal nodes are presented as leaves<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> trees with leaves at different heights.</p> <h4 id="binarymerkletreeinclusionproof"><a href="#binarymerkletreeinclusionproof" class="header-anchor">#</a> BinaryMerkleTreeInclusionProof</h4> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>siblings</code></td> <td><a href="#hashdigest">HashDigest</a><code>[]</code></td> <td>Sibling hash values, ordered starting from the leaf's neighbor.</td></tr></tbody></table> <p>A proof for a leaf in a <a href="#binary-merkle-tree">binary Merkle tree</a>, as per Section 2.1.1 of <a href="https://tools.ietf.org/html/rfc6962#section-2.1.1" target="_blank" rel="noopener noreferrer">Certificate Transparency (RFC-6962)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h3 id="namespace-merkle-tree"><a href="#namespace-merkle-tree" class="header-anchor">#</a> Namespace Merkle Tree</h3> <p><a href="#share">Shares</a> in Celestia are associated with a provided <em>namespace ID</em>. The Namespace Merkle Tree (NMT) is a variation of the <a href="https://eprint.iacr.org/2018/642" target="_blank" rel="noopener noreferrer">Merkle Interval Tree<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, which is itself an extension of the <a href="https://bitcointalk.org/index.php?topic=845978.0" target="_blank" rel="noopener noreferrer">Merkle Sum Tree<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. It allows for compact proofs around the inclusion or exclusion of shares with particular namespace IDs.</p> <p>Nodes contain three fields:</p> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>n_min</code></td> <td><a href="#type-aliases">NamespaceID</a></td> <td>Min namespace ID in subtree rooted at this node.</td></tr> <tr><td><code>n_max</code></td> <td><a href="#type-aliases">NamespaceID</a></td> <td>Max namespace ID in subtree rooted at this node.</td></tr> <tr><td><code>v</code></td> <td><a href="#hashdigest">HashDigest</a></td> <td>Node value.</td></tr></tbody></table> <p>The base case (an empty tree) is defined as:</p> <span class="codeblock" data-v-1eda75b2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-1eda75b2><span class="body__container" data-v-1eda75b2><span class="body__block" data-v-1eda75b2><span class="icons" data-v-1eda75b2><!----> <span class="icons__item" data-v-1eda75b2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-1eda75b2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-1eda75b2></path></svg> <span class="icons__item__tooltip" data-v-1eda75b2>
              Copy
            </span></span></span> <span class="body" data-v-1eda75b2><span class="body__wrapper" data-v-1eda75b2><span class="body__code" data-v-1eda75b2>node.n_min = 0x0000000000000000
node.n_max = 0x0000000000000000
node.v = 0xe3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
</span></span></span></span> <!----></span> <!----></span></span> <p>For leaf node <code>node</code> of <a href="#share">share</a> data <code>d</code>:</p> <span class="codeblock" data-v-1eda75b2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-1eda75b2><span class="body__container" data-v-1eda75b2><span class="body__block" data-v-1eda75b2><span class="icons" data-v-1eda75b2><!----> <span class="icons__item" data-v-1eda75b2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-1eda75b2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-1eda75b2></path></svg> <span class="icons__item__tooltip" data-v-1eda75b2>
              Copy
            </span></span></span> <span class="body" data-v-1eda75b2><span class="body__wrapper" data-v-1eda75b2><span class="body__code" data-v-1eda75b2>node.n_min = d.namespaceID
node.n_max = d.namespaceID
node.v = h(0x00, d.namespaceID, d.rawData)
</span></span></span></span> <!----></span> <!----></span></span> <p>The <code>namespaceID</code> message field here is the namespace ID of the leaf, which is a <a href="/specs/consensus.html#system-parameters"><code>NAMESPACE_ID_BYTES</code></a>-long byte array.</p> <p>Leaves in an NMT <strong>must</strong> be lexicographically sorted by namespace ID in ascending order.</p> <p>For internal node <code>node</code> with children <code>l</code> and <code>r</code>:</p> <span class="codeblock" data-v-1eda75b2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-1eda75b2><span class="body__container" data-v-1eda75b2><span class="body__block" data-v-1eda75b2><span class="icons" data-v-1eda75b2><!----> <span class="icons__item" data-v-1eda75b2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-1eda75b2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-1eda75b2></path></svg> <span class="icons__item__tooltip" data-v-1eda75b2>
              Copy
            </span></span></span> <span class="body" data-v-1eda75b2><span class="body__wrapper" data-v-1eda75b2><span class="body__code" data-v-1eda75b2>node.n_min = min(l.n_min, r.n_min)
if l.n_min == PARITY_SHARE_NAMESPACE_ID
  node.n_max = PARITY_SHARE_NAMESPACE_ID
else if r.n_min == PARITY_SHARE_NAMESPACE_ID
  node.n_max = l.n_max
else
  node.n_max = max(l.n_max, r.n_max)
node.v = h(0x01, l.n_min, l.n_max, l.v, r.l_min, r.l_max, r.v)
</span></span></span></span> <!----></span> <!----></span></span> <p>Note that the above snippet leverages the property that leaves are sorted by namespace ID: if <code>l.n_min</code> is <a href="/specs/consensus.html#reserved-state-subtree-ids"><code>PARITY_SHARE_NAMESPACE_ID</code></a>, so must <code>{l,r}.n_max</code>. By construction, either both the min and max namespace IDs of a node will be <a href="/specs/consensus.html#reserved-state-subtree-ids"><code>PARITY_SHARE_NAMESPACE_ID</code></a>, or neither will: if <code>r.n_min</code> is <a href="/specs/consensus.html#reserved-state-subtree-ids"><code>PARITY_SHARE_NAMESPACE_ID</code></a>, so must <code>r.n_max</code>.</p> <p>For some intuition: the min and max namespace IDs for subtree roots with at least one non-parity leaf (which includes the root of an NMT, as <a href="#2d-reed-solomon-encoding-scheme">the right half of an NMT as used in Celestia will be parity shares</a>) <em>ignore</em> the namespace ID for the parity leaves. Subtree roots with <em>only parity leaves</em> have their min and max namespace ID set to <a href="/specs/consensus.html#reserved-state-subtree-ids"><code>PARITY_SHARE_NAMESPACE_ID</code></a>. This allows for shorter proofs into the tree than if the namespace ID of parity shares was not ignored (which would cause the max namespace ID of the root to always be <a href="/specs/consensus.html#reserved-state-subtree-ids"><code>PARITY_SHARE_NAMESPACE_ID</code></a>).</p> <p>A compact commitment can be computed by taking the <a href="#hashing">hash</a> of the <a href="#serialization">serialized</a> root node.</p> <h4 id="namespacemerkletreeinclusionproof"><a href="#namespacemerkletreeinclusionproof" class="header-anchor">#</a> NamespaceMerkleTreeInclusionProof</h4> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>siblingValues</code></td> <td><a href="#hashdigest">HashDigest</a><code>[]</code></td> <td>Sibling hash values, ordered starting from the leaf's neighbor.</td></tr> <tr><td><code>siblingMins</code></td> <td><a href="#type-aliases">NamespaceID</a><code>[]</code></td> <td>Sibling min namespace IDs.</td></tr> <tr><td><code>siblingMaxes</code></td> <td><a href="#type-aliases">NamespaceID</a><code>[]</code></td> <td>Sibling max namespace IDs.</td></tr></tbody></table> <p>When verifying an NMT proof, the root hash is checked by reconstructing the root node <code>root_node</code> with the computed <code>root_node.v</code> (computed as with a <a href="#binarymerkletreeproof">plain Merkle proof</a>) and the provided <code>rootNamespaceIDMin</code> and <code>rootNamespaceIDMax</code> as the <code>root_node.n_min</code> and <code>root_node.n_max</code>, respectively.</p> <h3 id="sparse-merkle-tree"><a href="#sparse-merkle-tree" class="header-anchor">#</a> Sparse Merkle Tree</h3> <p>Sparse Merkle Trees (SMTs) are <em>sparse</em>, i.e. they contain mostly empty leaves. They can be used as key-value stores for arbitrary data, as each leaf is keyed by its index in the tree. Storage efficiency is achieved through clever use of implicit defaults, avoiding the need to store empty leaves.</p> <p>Additional rules are added on top of plain <a href="#binary-merkle-tree">binary Merkle trees</a>:</p> <ol><li>Default values are given to leaf nodes with empty leaves.</li> <li>While the above rule is sufficient to pre-compute the values of intermediate nodes that are roots of empty subtrees, a further simplification is to extend this default value to all nodes that are roots of empty subtrees. The 32-byte zero, i.e. <code>0x0000000000000000000000000000000000000000000000000000000000000000</code>, is used as the default value. This rule takes precedence over the above one.</li> <li>The number of hashing operations can be reduced to be logarithmic in the number of non-empty leaves on average, assuming a uniform distribution of non-empty leaf keys. An internal node that is the root of a subtree that contains exactly one non-empty leaf is replaced by that leaf's leaf node.</li></ol> <p>Nodes contain a single field:</p> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>v</code></td> <td><a href="#hashdigest">HashDigest</a></td> <td>Node value.</td></tr></tbody></table> <p>The base case (an empty tree) is defined as the <a href="#hashing">hash</a> of the empty string:</p> <span class="codeblock" data-v-1eda75b2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-1eda75b2><span class="body__container" data-v-1eda75b2><span class="body__block" data-v-1eda75b2><span class="icons" data-v-1eda75b2><!----> <span class="icons__item" data-v-1eda75b2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-1eda75b2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-1eda75b2></path></svg> <span class="icons__item__tooltip" data-v-1eda75b2>
              Copy
            </span></span></span> <span class="body" data-v-1eda75b2><span class="body__wrapper" data-v-1eda75b2><span class="body__code" data-v-1eda75b2>node.v = 0xe3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
</span></span></span></span> <!----></span> <!----></span></span> <p>For leaf node <code>node</code> of leaf data <code>d</code> with key <code>k</code>:</p> <span class="codeblock" data-v-1eda75b2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-1eda75b2><span class="body__container" data-v-1eda75b2><span class="body__block" data-v-1eda75b2><span class="icons" data-v-1eda75b2><!----> <span class="icons__item" data-v-1eda75b2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-1eda75b2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-1eda75b2></path></svg> <span class="icons__item__tooltip" data-v-1eda75b2>
              Copy
            </span></span></span> <span class="body" data-v-1eda75b2><span class="body__wrapper" data-v-1eda75b2><span class="body__code" data-v-1eda75b2>node.v = h(0x00, k, h(serialize(d)))
</span></span></span></span> <!----></span> <!----></span></span> <p>The key of leaf nodes must be prepended, since the index of a leaf node that is not at maximum depth cannot be determined without this information. Leaf values are hashed so that they do not need to be included in full in non-membership proofs.</p> <p>For internal node <code>node</code> with children <code>l</code> and <code>r</code>:</p> <span class="codeblock" data-v-1eda75b2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-1eda75b2><span class="body__container" data-v-1eda75b2><span class="body__block" data-v-1eda75b2><span class="icons" data-v-1eda75b2><!----> <span class="icons__item" data-v-1eda75b2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-1eda75b2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-1eda75b2></path></svg> <span class="icons__item__tooltip" data-v-1eda75b2>
              Copy
            </span></span></span> <span class="body" data-v-1eda75b2><span class="body__wrapper" data-v-1eda75b2><span class="body__code" data-v-1eda75b2>node.v = h(0x01, l.v, r.v)
</span></span></span></span> <!----></span> <!----></span></span> <h4 id="sparsemerkletreeinclusionproof"><a href="#sparsemerkletreeinclusionproof" class="header-anchor">#</a> SparseMerkleTreeInclusionProof</h4> <p>SMTs can further be extended with <em>compact</em> proofs. <a href="#verifying-annotated-merkle-proofs">Merkle proofs</a> are composed, among other things, of a list of sibling node values. We note that, since nodes that are roots of empty subtrees have known values (the default value), these values do not need to be provided explicitly; it is sufficient to simply identify which siblings in the Merkle branch are roots of empty subtrees, which can be done with one bit per sibling.</p> <p>For a Merkle branch of height <code>h</code>, an <code>h</code>-bit value is appended to the proof. The lowest bit corresponds to the sibling of the leaf node, and each higher bit corresponds to the next parent. A value of <code>1</code> indicates that the next value in the list of values provided explicitly in the proof should be used, and a value of <code>0</code> indicates that the default value should be used.</p> <p>A proof into an SMT is structured as:</p> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>depth</code></td> <td><code>uint16</code></td> <td>Depth of the leaf node. The root node is at depth <code>0</code>. Must be <code>&lt;= 256</code>.</td></tr> <tr><td><code>siblings</code></td> <td><a href="#hashdigest">HashDigest</a><code>[]</code></td> <td>Sibling hash values, ordered starting from the leaf's neighbor..</td></tr> <tr><td><code>includedSiblings</code></td> <td><code>byte[32]</code></td> <td>Bitfield of explicitly included sibling hashes.</td></tr></tbody></table> <p>The <code>includedSiblings</code> is ordered by most-significant-byte first, with each byte ordered by most-significant-bit first. The lowest bit corresponds the leaf node level.</p> <h2 id="erasure-coding"><a href="#erasure-coding" class="header-anchor">#</a> Erasure Coding</h2> <p>In order to enable trust-minimized light clients (i.e. light clients that do not rely on an honest majority of validating state assumption), it is critical that light clients can determine whether the data in each block is <em>available</em> or not, without downloading the whole block itself. The technique used here was formally described in the paper <a href="https://arxiv.org/abs/1809.09044" target="_blank" rel="noopener noreferrer">Fraud and Data Availability Proofs: Maximising Light Client Security and Scaling Blockchains with Dishonest Majorities<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>The remainder of the subsections below specify the <a href="#2d-reed-solomon-encoding-scheme">2D Reed-Solomon erasure coding scheme</a> used, along with the format of <a href="#share">shares</a> and how <a href="#available-data">available data</a> is arranged into shares.</p> <h3 id="reed-solomon-erasure-coding"><a href="#reed-solomon-erasure-coding" class="header-anchor">#</a> Reed-Solomon Erasure Coding</h3> <p>Note that while data is laid out in a two-dimensional square, rows and columns are erasure coded using a standard one-dimensional encoding.</p> <p>Reed-Solomon erasure coding is used as the underlying coding scheme. The parameters are:</p> <ul><li>16-bit Galois field</li> <li><a href="#header"><code>availableDataOriginalSquareSize</code></a> original pieces (maximum of <a href="/specs/consensus.html#constants"><code>AVAILABLE_DATA_ORIGINAL_SQUARE_MAX</code></a>)</li> <li><a href="#header"><code>availableDataOriginalSquareSize</code></a> parity pieces (maximum of <a href="/specs/consensus.html#constants"><code>AVAILABLE_DATA_ORIGINAL_SQUARE_MAX</code></a>) (i.e <code>availableDataOriginalSquareSize * 2</code> total pieces), for an erasure efficiency of 50%. In other words, any 50% of the pieces from the <code>availableDataOriginalSquareSize * 2</code> total pieces are enough to recover the original data.</li> <li><a href="/specs/consensus.html#constants"><code>SHARE_SIZE</code></a> bytes per piece</li></ul> <p>Note that <a href="#header"><code>availableDataOriginalSquareSize</code></a> may vary each block, and <a href="/specs/block_proposer.html#deciding-on-a-block-size">is decided by the block proposer of that block</a>. <a href="https://github.com/catid/leopard" target="_blank" rel="noopener noreferrer">Leopard-RS<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> is a C library that implements the above scheme with quasilinear runtime.</p> <h3 id="_2d-reed-solomon-encoding-scheme"><a href="#_2d-reed-solomon-encoding-scheme" class="header-anchor">#</a> 2D Reed-Solomon Encoding Scheme</h3> <p>The 2-dimensional data layout is described in this section. The roots of <a href="#namespace-merkle-tree">NMTs</a> for each row and column across four quadrants of data in a <code>2k * 2k</code> matrix of shares, <code>Q0</code> to <code>Q3</code> (shown below), must be computed. In other words, <code>2k</code> row roots and <code>2k</code> column roots must be computed. The row and column roots are stored in the <code>availableDataCommitments</code> of the <a href="#availabledataheader">AvailableDataHeader</a>.</p> <p><img src="/assets/img/rs2d_quadrants.ef72ab2c.svg" alt="fig: RS2D encoding: data quadrants."></p> <p>The data of <code>Q0</code> is the original data, and the remaining quadrants are parity data. Setting <code>k = availableDataOriginalSquareSize</code>, the original data first must be <a href="#share">split into shares</a> and <a href="#arranging-available-data-into-shares">arranged into a <code>k * k</code> matrix</a>. Then the parity data can be computed.</p> <p>Where <code>A -&gt; B</code> indicates that <code>B</code> is computed using <a href="#reed-solomon-erasure-coding">erasure coding</a> from <code>A</code>:</p> <ul><li><code>Q0 -&gt; Q1</code> for each row in <code>Q0</code> and <code>Q1</code></li> <li><code>Q0 -&gt; Q2</code> for each column in <code>Q0</code> and <code>Q2</code></li> <li><code>Q2 -&gt; Q3</code> for each row in <code>Q2</code> and <code>Q3</code></li></ul> <p><img src="/assets/img/rs2d_extending.3fb3beaa.svg" alt="fig: RS2D encoding: extending data."></p> <p>As an example, the parity data in the second column of <code>Q2</code> (in striped purple) is computed by <a href="#reed-solomon-erasure-coding">extending</a> the original data in the second column of <code>Q0</code> (in solid blue).</p> <p><img src="/assets/img/rs2d_extend.f05a5a20.svg" alt="fig: RS2D encoding: extending a column."></p> <p>Now that all four quadrants of the <code>2k * 2k</code> matrix are filled, the row and column roots can be computed. To do so, each row/column is used as the leaves of a <a href="#namespace-merkle-tree">NMT</a>, for which the compact root is computed (i.e. an extra hash operation over the NMT root is used to produce a single <a href="#hashdigest">HashDigest</a>). In this example, the fourth row root value is computed as the NMT root of the fourth row of <code>Q0</code> and the fourth row of <code>Q1</code> as leaves.</p> <p><img src="/assets/img/rs2d_row.5d30d765.svg" alt="fig: RS2D encoding: a row root."></p> <p>Finally, the <code>availableDataRoot</code> of the block <a href="#header">Header</a> is computed as the Merkle root of the <a href="#binary-merkle-tree">binary Merkle tree</a> with the row and column roots as leaves, in that order.</p> <p><img src="/assets/img/data_root.f90beb36.svg" alt="fig: Available data root."></p> <h3 id="share"><a href="#share" class="header-anchor">#</a> Share</h3> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>namespaceID</code></td> <td><a href="#type-aliases">NamespaceID</a></td> <td>Namespace ID of the share.</td></tr> <tr><td><code>rawData</code></td> <td><code>byte[SHARE_SIZE]</code></td> <td>Raw share data.</td></tr></tbody></table> <p>A share is a fixed-size data chunk associated with a namespace ID, whose data will be erasure-coded and committed to in <a href="#namespace-merkle-tree">Namespace Merkle trees</a>.</p> <p>A share's raw data <code>rawData</code> is interpreted differently depending on the namespace ID.</p> <p>For shares <strong>with a reserved namespace ID through <a href="/specs/consensus.html#constants"><code>NAMESPACE_ID_MAX_RESERVED</code></a></strong>:</p> <ul><li>The first <a href="/specs/consensus.html#constants"><code>NAMESPACE_ID_BYTES</code></a> of a share's raw data <code>rawData</code> is the namespace ID of that share, <code>namespaceID</code>.</li> <li>The next <a href="/specs/consensus.html#constants"><code>SHARE_RESERVED_BYTES</code></a> bytes (the <code>*</code> in the example layout figure below) is the starting byte of the length of the <a href="#serialization">canonically serialized</a> first request that starts in the share, or <code>0</code> if there is none, as a one-byte big-endian unsigned integer (i.e. canonical serialization is not used). In this example, with a share size of <code>256</code> the first byte would be <code>80</code> (or <code>0x50</code> in hex).</li> <li>The remaining <a href="/specs/consensus.html#constants"><code>SHARE_SIZE</code></a><code>-</code><a href="/specs/consensus.html#constants"><code>NAMESPACE_ID_BYTES</code></a><code>-</code><a href="/specs/consensus.html#constants"><code>SHARE_RESERVED_BYTES</code></a> bytes are request data.</li></ul> <p><img src="/assets/img/share.97979d36.svg" alt="fig: Reserved share."></p> <p>For shares <strong>with a namespace ID above <a href="/specs/consensus.html#constants"><code>NAMESPACE_ID_MAX_RESERVED</code></a> but below <a href="/specs/consensus.html#constants"><code>PARITY_SHARE_NAMESPACE_ID</code></a></strong>:</p> <ul><li>The first <a href="/specs/consensus.html#constants"><code>NAMESPACE_ID_BYTES</code></a> of a share's raw data <code>rawData</code> is the namespace ID of that share, <code>namespaceID</code>.</li> <li>The remaining <a href="/specs/consensus.html#constants"><code>SHARE_SIZE</code></a><code>-</code><a href="/specs/consensus.html#constants"><code>NAMESPACE_ID_BYTES</code></a> bytes are request data. In other words, the remaining bytes have no special meaning and are simply used to store data.</li></ul> <p>For shares <strong>with a namespace ID equal to <a href="/specs/consensus.html#constants"><code>PARITY_SHARE_NAMESPACE_ID</code></a></strong> (i.e. parity shares):</p> <ul><li>Bytes carry no special meaning.</li></ul> <p>For non-parity shares, if there is insufficient request data to fill the share, the remaining bytes are filled with <code>0</code>.</p> <h3 id="arranging-available-data-into-shares"><a href="#arranging-available-data-into-shares" class="header-anchor">#</a> Arranging Available Data Into Shares</h3> <p>The previous sections described how some original data, arranged into a <code>k * k</code> matrix, can be extended into a <code>2k * 2k</code> matrix and committed to with NMT roots. This section specifies how <a href="#available-data">available data</a> (which includes <a href="#transactiondata">transactions</a>, <a href="#intermediatestaterootdata">intermediate state roots</a>, <a href="#evidencedata">evidence</a>, and <a href="#messagedata">messages</a>) is arranged into the matrix in the first place.</p> <p>Then,</p> <ol><li>For each of <code>transactionData</code>, <code>intermediateStateRootData</code>, and <code>evidenceData</code>, <a href="#serialization">serialize</a>:
<ol><li>For each request in the list:
<ol><li><a href="#serialization">Serialize</a> the request (individually).</li> <li>Compute the length of each serialized request, <a href="#serialization">serialize the length</a>, and pre-pend the serialized request with its serialized length.</li></ol></li> <li>Split up the length/request pairs into <a href="/specs/consensus.html#constants"><code>SHARE_SIZE</code></a><code>-</code><a href="/specs/consensus.html#constants"><code>NAMESPACE_ID_BYTES</code></a><code>-</code><a href="/specs/consensus.html#constants"><code>SHARE_RESERVED_BYTES</code></a>-byte chunks.</li> <li>Create a <a href="#share">share</a> out of each chunk. This data has a <em>reserved</em> namespace ID, so the first <a href="/specs/consensus.html#constants"><code>NAMESPACE_ID_BYTES</code></a><code>+</code><a href="/specs/consensus.html#constants"><code>SHARE_RESERVED_BYTES</code></a> bytes for these shares must be <a href="#share">set specially</a>.</li></ol></li> <li>Concatenate the lists of shares in the order: transactions, intermediate state roots, evidence.</li></ol> <p>Note that by construction, each share only has a single namespace, and that the list of concatenated shares is <a href="/specs/consensus.html#reserved-namespace-ids">lexicographically ordered by namespace ID</a>.</p> <p>These shares are arranged in the <a href="#2d-reed-solomon-encoding-scheme">first quadrant</a> (<code>Q0</code>) of the <code>availableDataOriginalSquareSize*2 * availableDataOriginalSquareSize*2</code> available data matrix in <em>row-major</em> order. In the example below, each reserved data element takes up exactly one share.</p> <p><img src="/assets/img/rs2d_originaldata_reserved.1f38216a.svg" alt="fig: Original data: reserved."></p> <p>Each message in the list <code>messageData</code>:</p> <ol><li><a href="#serialization">Serialize</a> the message (individually).</li> <li>Compute the length of each serialized message, <a href="#serialization">serialize the length</a>, and pre-pend the serialized message with its serialized length.</li> <li>Split up the length/message pairs into <a href="/specs/consensus.html#constants"><code>SHARE_SIZE</code></a><code>-</code><a href="/specs/consensus.html#constants"><code>NAMESPACE_ID_BYTES</code></a>-byte chunks.</li> <li>Create a <a href="#share">share</a> out of each chunk. The first <a href="/specs/consensus.html#constants"><code>NAMESPACE_ID_BYTES</code></a> bytes for these shares is <a href="#share">set to the namespace ID</a>.</li></ol> <p>For each message, it is placed in the available data matrix, with row-major order, as follows:</p> <ol><li>Place the first share of the message at the next unused location in the matrix, then place the remaining shares in the following locations.</li></ol> <p>Transactions <a href="#transaction">must commit to a Merkle root of a list of hashes</a> that are each guaranteed (assuming the block is valid) to be subtree roots in one or more of the row NMTs. For additional info, see <a href="/rationale/message_block_layout.html">the rationale document</a> for this section.</p> <p>However, with only the rule above, interaction between the block producer and transaction sender may be required to compute a commitment to the message the transaction sender can sign over. To remove interaction, messages can optionally be laid out using a non-interactive default:</p> <ol><li>Place the first share of the message at the next unused location in the matrix whose column in aligned with the largest power of 2 that is not larger than the message length or <a href="#header"><code>availableDataOriginalSquareSize</code></a>, then place the remaining shares in the following locations <strong>unless</strong> there are insufficient unused locations in the row.</li> <li>If there are insufficient unused locations in the row, place the first share of the message at the first column of the next row. Then place the remaining shares in the following locations. By construction, any message whose length is greater than <a href="#header"><code>availableDataOriginalSquareSize</code></a> will be placed in this way.</li></ol> <p>In the example below, two messages (of lengths 2 and 1, respectively) are placed using the aforementioned default non-interactive rules.</p> <p><img src="/assets/img/rs2d_originaldata_message.39f8ccae.svg" alt="fig: Original data: messages."></p> <p>The non-interactive default rules may introduce empty shares that do not belong to any message (in the example above, the top-right share is empty). These are zeroes with namespace ID equal to the either <a href="/specs/consensus.html#constants"><code>TAIL_TRANSACTION_PADDING_NAMESPACE_ID</code></a> if between a request with a reserved namespace ID and a message, or the namespace ID of the previous message if succeeded by a message. See the <a href="/rationale/message_block_layout.html">rationale doc</a> for more info.</p> <h2 id="available-data"><a href="#available-data" class="header-anchor">#</a> Available Data</h2> <h3 id="transactiondata"><a href="#transactiondata" class="header-anchor">#</a> TransactionData</h3> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>wrappedTransactions</code></td> <td><a href="#wrappedtransaction">WrappedTransaction</a><code>[]</code></td> <td>List of wrapped transactions.</td></tr></tbody></table> <h4 id="wrappedtransaction"><a href="#wrappedtransaction" class="header-anchor">#</a> WrappedTransaction</h4> <p>Wrapped transactions include additional metadata by the block proposer that is committed to in the <a href="#arranging-available-data-into-shares">available data matrix</a>.</p> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>index</code></td> <td><code>uint64</code></td> <td>Index of this transaction in the list of wrapped transactions. This information is lost when splitting transactions into <a href="#share">fixed-sized shares</a>, and needs to be re-added here for fraud proof support. Allows linking a transaction to an <a href="#wrappedintermediatestateroot">intermediate state root</a>.</td></tr> <tr><td><code>transaction</code></td> <td><a href="#transaction">Transaction</a></td> <td>Actual transaction.</td></tr> <tr><td><code>messageStartIndex</code></td> <td><code>uint64</code></td> <td><em>Optional, only used if transaction pays for a message or padding</em>. Share index (in row-major order) of first share of message this transaction pays for. Needed for light verification of proper message inclusion.</td></tr></tbody></table> <h4 id="transaction"><a href="#transaction" class="header-anchor">#</a> Transaction</h4> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>signedTransactionData</code></td> <td><a href="#signedtransactiondata">SignedTransactionData</a></td> <td>Data payload that is signed over.</td></tr> <tr><td><code>signature</code></td> <td><a href="#signature">Signature</a></td> <td>Signature.</td></tr></tbody></table> <h4 id="signedtransactiondata"><a href="#signedtransactiondata" class="header-anchor">#</a> SignedTransactionData</h4> <span class="codeblock" data-v-1eda75b2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-1eda75b2><span class="body__container" data-v-1eda75b2><span class="body__block" data-v-1eda75b2><span class="icons" data-v-1eda75b2><!----> <span class="icons__item" data-v-1eda75b2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-1eda75b2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-1eda75b2></path></svg> <span class="icons__item__tooltip" data-v-1eda75b2>
              Copy
            </span></span></span> <span class="body" data-v-1eda75b2><span class="body__wrapper" data-v-1eda75b2><span class="body__code" data-v-1eda75b2>enum TransactionType : uint8_t {
    Transfer = 1,
    PayForMessage = 2,
    CreateValidator = 3,
    BeginUnbondingValidator = 4,
    UnbondValidator = 5,
    CreateDelegation = 6,
    BeginUnbondingDelegation = 7,
    UnbondDelegation = 8,
    Burn = 9,
    RedelegateCommission = 10,
    RedelegateReward = 11,
};
</span></span></span></span> <!----></span> <!----></span></span> <p>Signed transaction data comes in a number of types:</p> <ol><li><a href="#signedtransactiondatatransfer">Transfer</a></li> <li><a href="#signedtransactiondatapayformessage">PayForMessage</a></li> <li><a href="#signedtransactiondatacreatevalidator">CreateValidator</a></li> <li><a href="#signedtransactiondatabeginunbondingvalidator">BeginUnbondingValidator</a></li> <li><a href="#signedtransactiondataunbondvalidator">UnbondValidator</a></li> <li><a href="#signedtransactiondatacreatedelegation">CreateDelegation</a></li> <li><a href="#signedtransactiondatabeginunbondingdelegation">BeginUnbondingDelegation</a></li> <li><a href="#signedtransactiondataunbonddelegation">UnbondDelegation</a></li> <li><a href="#signedtransactiondataburn">Burn</a></li> <li><a href="#signedtransactionredelegatecommission">RedelegateCommission</a></li> <li><a href="#signedtransactionredelegatereward">RedelegateReward</a></li></ol> <p>Common fields are denoted here to avoid repeating descriptions:</p> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>type</code></td> <td><code>TransactionType</code></td> <td>Type of the transaction. Each type indicates a different state transition.</td></tr> <tr><td><code>amount</code></td> <td><a href="#type-aliases">Amount</a></td> <td>Amount of coins to send, in <code>1u</code>.</td></tr> <tr><td><code>to</code></td> <td><a href="#address">Address</a></td> <td>Recipient's address.</td></tr> <tr><td><code>fee</code></td> <td><a href="#transactionfee">TransactionFee</a></td> <td>The fee information for this transaction.</td></tr> <tr><td><code>nonce</code></td> <td><a href="#type-aliases">Nonce</a></td> <td>Nonce of sender.</td></tr></tbody></table> <h5 id="signedtransactiondatatransfer"><a href="#signedtransactiondatatransfer" class="header-anchor">#</a> SignedTransactionDataTransfer</h5> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>type</code></td> <td><code>TransactionType</code></td> <td>Must be <code>TransactionType.Transfer</code>.</td></tr> <tr><td><code>amount</code></td> <td><a href="#type-aliases">Amount</a></td> <td></td></tr> <tr><td><code>to</code></td> <td><a href="#address">Address</a></td> <td></td></tr> <tr><td><code>fee</code></td> <td><a href="#transactionfee">TransactionFee</a></td> <td></td></tr> <tr><td><code>nonce</code></td> <td><a href="#type-aliases">Nonce</a></td> <td></td></tr></tbody></table> <p>Transfers <code>amount</code> coins to <code>to</code>.</p> <h5 id="signedtransactiondatapayformessage"><a href="#signedtransactiondatapayformessage" class="header-anchor">#</a> SignedTransactionDataPayForMessage</h5> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>type</code></td> <td><code>TransactionType</code></td> <td>Must be <code>TransactionType.PayForMessage</code>.</td></tr> <tr><td><code>fee</code></td> <td><a href="#transactionfee">TransactionFee</a></td> <td></td></tr> <tr><td><code>nonce</code></td> <td><a href="#type-aliases">Nonce</a></td> <td></td></tr> <tr><td><code>messageNamespaceID</code></td> <td><a href="#type-aliases"><code>NamespaceID</code></a></td> <td>Namespace ID of message this transaction pays a fee for.</td></tr> <tr><td><code>messageSize</code></td> <td><code>uint64</code></td> <td>Size of message this transaction pays a fee for, in <code>byte</code>s.</td></tr> <tr><td><code>messageShareCommitment</code></td> <td><a href="#hashdigest">HashDigest</a></td> <td>Commitment to message shares (details below).</td></tr></tbody></table> <p>Pays for the inclusion of a <a href="#message">message</a> in the same block.</p> <p>The commitment to message shares <code>messageShareCommitment</code> is a <a href="#binary-merkle-tree">Merkle root</a> of message share roots. Each message share root is <a href="#arranging-available-data-into-shares">a subtree root in a row NMT</a>. For rationale, see <a href="/rationale/message_block_layout.html">rationale doc</a>.</p> <h5 id="signedtransactiondatacreatevalidator"><a href="#signedtransactiondatacreatevalidator" class="header-anchor">#</a> SignedTransactionDataCreateValidator</h5> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>type</code></td> <td><code>TransactionType</code></td> <td>Must be <code>TransactionType.CreateValidator</code>.</td></tr> <tr><td><code>fee</code></td> <td><a href="#transactionfee">TransactionFee</a></td> <td></td></tr> <tr><td><code>nonce</code></td> <td><a href="#type-aliases">Nonce</a></td> <td></td></tr> <tr><td><code>commissionRate</code></td> <td><a href="#decimal">Decimal</a></td> <td></td></tr></tbody></table> <p>Create a new <a href="#validator">Validator</a> at this address.</p> <h5 id="signedtransactiondatabeginunbondingvalidator"><a href="#signedtransactiondatabeginunbondingvalidator" class="header-anchor">#</a> SignedTransactionDataBeginUnbondingValidator</h5> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>type</code></td> <td><code>TransactionType</code></td> <td>Must be <code>TransactionType.BeginUnbondingValidator</code>.</td></tr> <tr><td><code>fee</code></td> <td><a href="#transactionfee">TransactionFee</a></td> <td></td></tr> <tr><td><code>nonce</code></td> <td><a href="#type-aliases">Nonce</a></td> <td></td></tr></tbody></table> <p>Begin unbonding the <a href="#validator">Validator</a> at this address.</p> <h5 id="signedtransactiondataunbondvalidator"><a href="#signedtransactiondataunbondvalidator" class="header-anchor">#</a> SignedTransactionDataUnbondValidator</h5> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>type</code></td> <td><code>TransactionType</code></td> <td>Must be <code>TransactionType.UnbondValidator</code>.</td></tr> <tr><td><code>fee</code></td> <td><a href="#transactionfee">TransactionFee</a></td> <td></td></tr> <tr><td><code>nonce</code></td> <td><a href="#type-aliases">Nonce</a></td> <td></td></tr></tbody></table> <p>Finish unbonding the <a href="#validator">Validator</a> at this address.</p> <h5 id="signedtransactiondatacreatedelegation"><a href="#signedtransactiondatacreatedelegation" class="header-anchor">#</a> SignedTransactionDataCreateDelegation</h5> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>type</code></td> <td><code>TransactionType</code></td> <td>Must be <code>TransactionType.CreateDelegation</code>.</td></tr> <tr><td><code>amount</code></td> <td><a href="#type-aliases">Amount</a></td> <td></td></tr> <tr><td><code>to</code></td> <td><a href="#address">Address</a></td> <td></td></tr> <tr><td><code>fee</code></td> <td><a href="#transactionfee">TransactionFee</a></td> <td></td></tr> <tr><td><code>nonce</code></td> <td><a href="#type-aliases">Nonce</a></td> <td></td></tr></tbody></table> <p>Create a new <a href="#delegation">Delegation</a> of <code>amount</code> coins worth of voting power for validator with address <code>to</code>.</p> <h5 id="signedtransactiondatabeginunbondingdelegation"><a href="#signedtransactiondatabeginunbondingdelegation" class="header-anchor">#</a> SignedTransactionDataBeginUnbondingDelegation</h5> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>type</code></td> <td><code>TransactionType</code></td> <td>Must be <code>TransactionType.BeginUnbondingDelegation</code>.</td></tr> <tr><td><code>fee</code></td> <td><a href="#transactionfee">TransactionFee</a></td> <td></td></tr> <tr><td><code>nonce</code></td> <td><a href="#type-aliases">Nonce</a></td> <td></td></tr></tbody></table> <p>Begin unbonding the <a href="#delegation">Delegation</a> at this address.</p> <h5 id="signedtransactiondataunbonddelegation"><a href="#signedtransactiondataunbonddelegation" class="header-anchor">#</a> SignedTransactionDataUnbondDelegation</h5> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>type</code></td> <td><code>TransactionType</code></td> <td>Must be <code>TransactionType.UnbondDelegation</code>.</td></tr> <tr><td><code>fee</code></td> <td><a href="#transactionfee">TransactionFee</a></td> <td></td></tr> <tr><td><code>nonce</code></td> <td><a href="#type-aliases">Nonce</a></td> <td></td></tr></tbody></table> <p>Finish unbonding the <a href="#delegation">Delegation</a> at this address.</p> <h5 id="signedtransactiondataburn"><a href="#signedtransactiondataburn" class="header-anchor">#</a> SignedTransactionDataBurn</h5> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>type</code></td> <td><code>TransactionType</code></td> <td>Must be <code>TransactionType.Burn</code>.</td></tr> <tr><td><code>amount</code></td> <td><a href="#type-aliases">Amount</a></td> <td></td></tr> <tr><td><code>fee</code></td> <td><a href="#transactionfee">TransactionFee</a></td> <td></td></tr> <tr><td><code>nonce</code></td> <td><a href="#type-aliases">Nonce</a></td> <td></td></tr> <tr><td><code>graffiti</code></td> <td><a href="#type-aliases">Graffiti</a></td> <td>Graffiti to indicate the reason for burning.</td></tr></tbody></table> <h5 id="signedtransactionredelegatecommission"><a href="#signedtransactionredelegatecommission" class="header-anchor">#</a> SignedTransactionRedelegateCommission</h5> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>type</code></td> <td><code>TransactionType</code></td> <td>Must be <code>TransactionType.RedelegateCommission</code>.</td></tr> <tr><td><code>to</code></td> <td><a href="#address">Address</a></td> <td></td></tr> <tr><td><code>fee</code></td> <td><a href="#transactionfee">TransactionFee</a></td> <td></td></tr> <tr><td><code>nonce</code></td> <td><a href="#type-aliases">Nonce</a></td> <td></td></tr></tbody></table> <p>Assigns validator's pending commission to a delegation.</p> <h5 id="signedtransactionredelegatereward"><a href="#signedtransactionredelegatereward" class="header-anchor">#</a> SignedTransactionRedelegateReward</h5> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>type</code></td> <td><code>TransactionType</code></td> <td>Must be <code>TransactionType.RedelegateReward</code>.</td></tr> <tr><td><code>fee</code></td> <td><a href="#transactionfee">TransactionFee</a></td> <td></td></tr> <tr><td><code>nonce</code></td> <td><a href="#type-aliases">Nonce</a></td> <td></td></tr></tbody></table> <p>Adds delegation's pending rewards to voting power.</p> <h3 id="intermediatestaterootdata"><a href="#intermediatestaterootdata" class="header-anchor">#</a> IntermediateStateRootData</h3> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>wrappedIntermediateStateRoots</code></td> <td><a href="#wrappedintermediatestateroot">WrappedIntermediateStateRoot</a><code>[]</code></td> <td>List of wrapped intermediate state roots.</td></tr></tbody></table> <h4 id="wrappedintermediatestateroot"><a href="#wrappedintermediatestateroot" class="header-anchor">#</a> WrappedIntermediateStateRoot</h4> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>index</code></td> <td><code>uint64</code></td> <td>Index of this intermediate state root in the list of intermediate state roots. This information is lost when splitting intermediate state roots into <a href="#share">fixed-sized shares</a>, and needs to be re-added here for fraud proof support. Allows linking an intermediate state root to a <a href="#wrappedtransaction">transaction</a>.</td></tr> <tr><td><code>intermediateStateRoot</code></td> <td><a href="#intermediatestateroot">IntermediateStateRoot</a></td> <td>Intermediate state root. Used for fraud proofs.</td></tr></tbody></table> <h4 id="intermediatestateroot"><a href="#intermediatestateroot" class="header-anchor">#</a> IntermediateStateRoot</h4> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>root</code></td> <td><a href="#hashdigest">HashDigest</a></td> <td>Root of intermediate state, which is composed of the global state and the validator set.</td></tr></tbody></table> <h3 id="evidencedata"><a href="#evidencedata" class="header-anchor">#</a> EvidenceData</h3> <p>Wrapper for evidence data.</p> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>evidences</code></td> <td><a href="#evidence">Evidence</a><code>[]</code></td> <td>List of evidence used for slashing conditions.</td></tr></tbody></table> <h4 id="evidence"><a href="#evidence" class="header-anchor">#</a> Evidence</h4> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>pubKey</code></td> <td><a href="#publickey">PublicKey</a></td> <td></td></tr> <tr><td><code>voteA</code></td> <td><a href="#vote">Vote</a></td> <td></td></tr> <tr><td><code>voteB</code></td> <td><a href="#vote">Vote</a></td> <td></td></tr></tbody></table> <h4 id="publickey"><a href="#publickey" class="header-anchor">#</a> PublicKey</h4> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>x</code></td> <td><code>byte[32]</code></td> <td><code>x</code> value of public key.</td></tr> <tr><td><code>y</code></td> <td><code>byte[32]</code></td> <td><code>y</code> value of public key.</td></tr></tbody></table> <h4 id="vote"><a href="#vote" class="header-anchor">#</a> Vote</h4> <span class="codeblock" data-v-1eda75b2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-1eda75b2><span class="body__container" data-v-1eda75b2><span class="body__block" data-v-1eda75b2><span class="icons" data-v-1eda75b2><!----> <span class="icons__item" data-v-1eda75b2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-1eda75b2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-1eda75b2></path></svg> <span class="icons__item__tooltip" data-v-1eda75b2>
              Copy
            </span></span></span> <span class="body" data-v-1eda75b2><span class="body__wrapper" data-v-1eda75b2><span class="body__code" data-v-1eda75b2>enum VoteType : uint8_t {
    Prevote = 1,
    Precommit = 2,
};
</span></span></span></span> <!----></span> <!----></span></span> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>type</code></td> <td><code>VoteType</code></td> <td></td></tr> <tr><td><code>height</code></td> <td><a href="#type-aliases">Height</a></td> <td></td></tr> <tr><td><code>round</code></td> <td><a href="#type-aliases">Round</a></td> <td></td></tr> <tr><td><code>headerHash</code></td> <td><a href="#hashdigest">HashDigest</a></td> <td></td></tr> <tr><td><code>timestamp</code></td> <td><a href="#timestamp">Timestamp</a></td> <td></td></tr> <tr><td><code>signature</code></td> <td><a href="#signature">Signature</a></td> <td></td></tr></tbody></table> <h3 id="messagedata"><a href="#messagedata" class="header-anchor">#</a> MessageData</h3> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>messages</code></td> <td><a href="#message">Message</a><code>[]</code></td> <td>List of messages.</td></tr></tbody></table> <h4 id="message"><a href="#message" class="header-anchor">#</a> Message</h4> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>namespaceID</code></td> <td><a href="#type-aliases">NamespaceID</a></td> <td>Namespace ID of this message.</td></tr> <tr><td><code>rawData</code></td> <td><code>byte[]</code></td> <td>Raw message bytes.</td></tr></tbody></table> <h2 id="state"><a href="#state" class="header-anchor">#</a> State</h2> <p>The state of the Celestia chain is intentionally restricted to containing only account balances and the validator set metadata. One unified <a href="#sparse-merkle-tree">Sparse Merkle Tree</a> is maintained for the entire chain state, the <em>state tree</em>. The root of this tree is committed to in the <a href="#header">block header</a>.</p> <p>The state tree is separated into <code>2**(8*STATE_SUBTREE_RESERVED_BYTES)</code> subtrees, each of which can be used to store a different component of the state. This is done by slicing off the highest <code>STATE_SUBTREE_RESERVED_BYTES</code> bytes from the key and replacing them with the appropriate <a href="/specs/consensus.html#reserved-state-subtree-ids">reserved state subtree ID</a>. Reducing the key size within subtrees also reduces the collision resistance of keys by <code>8*STATE_SUBTREE_RESERVED_BYTES</code> bits, but this is not an issue due the number of bits removed being small.</p> <p>A number of subtrees are maintained:</p> <ol><li><a href="#account">Accounts</a></li> <li><a href="#validator">Active validator set</a></li> <li><a href="#validator">Inactive validator set</a></li> <li><a href="#delegation">Delegation set</a></li> <li><a href="#message-paid">Message shares paid for</a></li></ol> <h3 id="stateelement"><a href="#stateelement" class="header-anchor">#</a> StateElement</h3> <p>Data structure for state elements is given below:</p> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>key</code></td> <td><code>byte[32]</code></td> <td>Keys are byte arrays with size 32.</td></tr> <tr><td><code>value</code></td> <td><a href="#account">Account</a>, <a href="#delegation">Delegation</a>, <a href="#validator">Validator</a>, <a href="#activevalidatorcount">ActiveValidatorCount</a>, <a href="#activevotingpower">ActiveVotingPower</a>, <a href="#proposerblockreward">ProposerBlockReward</a>, <a href="#proposerinitialvotingpower">ProposerInitialVotingPower</a>, <a href="#validatorqueuehead">ValidatorQueueHead</a>, <a href="#messagepaidhead">MessagePaidHead</a></td> <td><code>value</code> can be of different types depending on the state elements listed below. There exists a unique protobuf for different state elements.</td></tr></tbody></table> <h3 id="account"><a href="#account" class="header-anchor">#</a> Account</h3> <span class="codeblock" data-v-1eda75b2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-1eda75b2><span class="body__container" data-v-1eda75b2><span class="body__block" data-v-1eda75b2><span class="icons" data-v-1eda75b2><!----> <span class="icons__item" data-v-1eda75b2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-1eda75b2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-1eda75b2></path></svg> <span class="icons__item__tooltip" data-v-1eda75b2>
              Copy
            </span></span></span> <span class="body" data-v-1eda75b2><span class="body__wrapper" data-v-1eda75b2><span class="body__code" data-v-1eda75b2>enum AccountStatus : uint8_t {
    None = 1,
    DelegationBonded = 2,
    DelegationUnbonding = 3,
    ValidatorQueued = 4,
    ValidatorBonded = 5,
    ValidatorUnbonding = 6,
    ValidatorUnbonded = 7,
};
</span></span></span></span> <!----></span> <!----></span></span> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>balance</code></td> <td><a href="#type-aliases">Amount</a></td> <td>Coin balance.</td></tr> <tr><td><code>nonce</code></td> <td><a href="#type-aliases">Nonce</a></td> <td>Account nonce. Every outgoing transaction from this account increments the nonce.</td></tr> <tr><td><code>status</code></td> <td><code>AccountStatus</code></td> <td>Validator or delegation status of this account.</td></tr></tbody></table> <p>The <code>status</code> of an account indicates weather it is a validator (<code>AccountStatus.Validator*</code>), delegating to a validator (<code>AccountStatus.Delegation*</code>), or neither (<code>AccountStatus.None</code>). Being a validator and delegating are mutually exclusive, and only a single validator can be delegated to.</p> <p>Delegations have two statuses:</p> <ol><li><code>DelegationBonded</code>: This delegation is enabled for a <code>Queued</code> <em>or</em> <code>Bonded</code> validator. Delegations to a <code>Queued</code> validator can be withdrawn immediately, while delegations for a <code>Bonded</code> validator must be unbonded first.</li> <li><code>DelegationUnbonding</code>: This delegation is unbonding. It will remain in this status for at least <code>UNBONDING_DURATION</code> blocks, and while unbonding may still be slashed. Once the unbonding duration has expired, the delegation can be withdrawn.</li></ol> <p>Validators have four statuses:</p> <ol><li><code>ValidatorQueued</code>: This validator has entered the queue to become an active validator. Once the next validator set transition occurs, if this validator has sufficient voting power (including its own stake and stake delegated to it) to be in the top <code>MAX_VALIDATORS</code> validators by voting power, it will become an active, i.e. <code>ValidatorBonded</code> validator. Until bonded, this validator can immediately exit the queue.</li> <li><code>ValidatorBonded</code>: This validator is active and bonded. It can propose new blocks and vote on proposed blocks. Once bonded, an active validator must go through an unbonding process until its stake can be freed.</li> <li><code>ValidatorUnbonding</code>: This validator is in the process of unbonding, which can be voluntary (the validator decided to stop being an active validator) or forced (the validator committed a slashable offence and was kicked from the active validator set). Validators will remain in this status for at least <code>UNBONDING_DURATION</code> blocks, and while unbonding may still be slashed.</li> <li><code>ValidatorUnbonded</code>: This validator has completed its unbonding and has withdrawn its stake. The validator object will remain in this status until <code>delegatedCount</code> reaches zero, at which point it is destroyed.</li></ol> <p>In the accounts subtree, accounts (i.e. leaves) are keyed by the <a href="#hashdigest">hash</a> of their <a href="#address">address</a>. The first byte is then replaced with <a href="/specs/consensus.html#reserved-state-subtree-ids"><code>ACCOUNTS_SUBTREE_ID</code></a>.</p> <h3 id="delegation"><a href="#delegation" class="header-anchor">#</a> Delegation</h3> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>validator</code></td> <td><a href="#address">Address</a></td> <td>The validator being delegating to.</td></tr> <tr><td><code>stakedBalance</code></td> <td><a href="#type-aliases">VotingPower</a></td> <td>Delegated stake, in <code>4u</code>.</td></tr> <tr><td><code>beginEntry</code></td> <td><a href="#periodentry">PeriodEntry</a></td> <td>Entry when delegation began.</td></tr> <tr><td><code>endEntry</code></td> <td><a href="#periodentry">PeriodEntry</a></td> <td>Entry when delegation ended (i.e. began unbonding).</td></tr> <tr><td><code>unbondingHeight</code></td> <td><a href="#type-aliases">Height</a></td> <td>Block height delegation began unbonding.</td></tr></tbody></table> <p>Delegation objects represent a delegation.</p> <p>In the delegation subtree, delegations are keyed by the <a href="#hashdigest">hash</a> of their <a href="#address">address</a>. The first byte is then replaced with <a href="/specs/consensus.html#reserved-state-subtree-ids"><code>DELEGATIONS_SUBTREE_ID</code></a>.</p> <h3 id="validator"><a href="#validator" class="header-anchor">#</a> Validator</h3> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>commissionRewards</code></td> <td><code>uint64</code></td> <td>Validator's commission rewards, in <code>1u</code>.</td></tr> <tr><td><code>commissionRate</code></td> <td><a href="#decimal">Decimal</a></td> <td>Commission rate.</td></tr> <tr><td><code>delegatedCount</code></td> <td><code>uint32</code></td> <td>Number of accounts delegating to this validator.</td></tr> <tr><td><code>votingPower</code></td> <td><a href="#type-aliases">VotingPower</a></td> <td>Total voting power as staked balance + delegated stake, in <code>4u</code>.</td></tr> <tr><td><code>pendingRewards</code></td> <td><a href="#type-aliases">Amount</a></td> <td>Rewards collected so far this period, in <code>1u</code>.</td></tr> <tr><td><code>latestEntry</code></td> <td><a href="#periodentry">PeriodEntry</a></td> <td>Latest entry, used for calculating reward distribution.</td></tr> <tr><td><code>unbondingHeight</code></td> <td><a href="#type-aliases">Height</a></td> <td>Block height validator began unbonding.</td></tr> <tr><td><code>isSlashed</code></td> <td><code>bool</code></td> <td>If this validator has been slashed or not.</td></tr> <tr><td><code>slashRate</code></td> <td><a href="#decimal">Decimal</a></td> <td><em>Optional</em>, only if <code>isSlashed</code> is set. Rate at which this validator has been slashed.</td></tr> <tr><td><code>next</code></td> <td><a href="#type-aliases">Address</a></td> <td>Next validator in the queue. Zero if this validator is not in the queue.</td></tr></tbody></table> <p>Validator objects represent all the information needed to be keep track of a validator.</p> <p>In the validators subtrees, validators are keyed by the <a href="#hashdigest">hash</a> of their <a href="#address">address</a>. The first byte is then replaced with <a href="/specs/consensus.html#reserved-state-subtree-ids"><code>ACTIVE_VALIDATORS_SUBTREE_ID</code></a> for the active validator set or <a href="/specs/consensus.html#reserved-state-subtree-ids"><code>INACTIVE_VALIDATORS_SUBTREE_ID</code></a> for the inactive validator set. Active validators are bonded, (i.e. <code>ValidatorBonded</code>), while inactive validators are not bonded (i.e. <code>ValidatorBonded</code>). By construction, the validators subtrees will be a subset of a mirror of the <a href="#account">accounts subtree</a>.</p> <p>The validator queue (i.e. validators with status <code>ValidatorQueued</code>) is a subset of the inactive validator set. This queue is represented as a linked list, with each validator pointing to the <code>next</code> validator in the queue, and the head of the linked list stored in <a href="#validatorqueuehead">ValidatorQueueHead</a>.</p> <h3 id="activevalidatorcount"><a href="#activevalidatorcount" class="header-anchor">#</a> ActiveValidatorCount</h3> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>numValidators</code></td> <td><code>uint32</code></td> <td>Number of active validators.</td></tr></tbody></table> <p>Since the <a href="#validator">active validator set</a> is stored in a <a href="#sparse-merkle-tree">Sparse Merkle Tree</a>, there is no compact way of proving that the number of active validators exceeds <code>MAX_VALIDATORS</code> without keeping track of the number of active validators. The active validator count is stored in the active validators subtree, and is keyed with <code>0</code> (i.e. <code>0x0000000000000000000000000000000000000000000000000000000000000000</code>), with the first byte replaced with <code>ACTIVE_VALIDATORS_SUBTREE_ID</code>.</p> <h3 id="activevotingpower"><a href="#activevotingpower" class="header-anchor">#</a> ActiveVotingPower</h3> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>votingPower</code></td> <td><code>uint64</code></td> <td>Active voting power.</td></tr></tbody></table> <p>Since the <a href="#validator">active validator set</a> is stored in a <a href="#sparse-merkle-tree">Sparse Merkle Tree</a>, there is no compact way of proving the active voting power. The active voting power is stored in the active validators subtree, and is keyed with <code>1</code> (i.e. <code>0x0000000000000000000000000000000000000000000000000000000000000001</code>), with the first byte replaced with <code>ACTIVE_VALIDATORS_SUBTREE_ID</code>.</p> <h3 id="proposerblockreward"><a href="#proposerblockreward" class="header-anchor">#</a> ProposerBlockReward</h3> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>reward</code></td> <td><code>uint64</code></td> <td>Total block reward (subsidy + fees) in current block so far. Reset each block.</td></tr></tbody></table> <p>The current block reward for the proposer is kept track of here. This is keyed with <code>2</code> (i.e. <code>0x0000000000000000000000000000000000000000000000000000000000000002</code>), with the first byte replaced with <code>ACTIVE_VALIDATORS_SUBTREE_ID</code>.</p> <h3 id="proposerinitialvotingpower"><a href="#proposerinitialvotingpower" class="header-anchor">#</a> ProposerInitialVotingPower</h3> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>votingPower</code></td> <td><code>uint64</code></td> <td>Voting power of the proposer at the start of each block. Set each block.</td></tr></tbody></table> <p>The proposer's voting power at the beginning of the block is kept track of here. This is keyed with <code>3</code> (i.e. <code>0x0000000000000000000000000000000000000000000000000000000000000003</code>), with the first byte replaced with <code>ACTIVE_VALIDATORS_SUBTREE_ID</code>.</p> <h3 id="validatorqueuehead"><a href="#validatorqueuehead" class="header-anchor">#</a> ValidatorQueueHead</h3> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>head</code></td> <td><a href="#address">Address</a></td> <td>Address of inactive validator at the head of the validator queue.</td></tr></tbody></table> <p>The head of the queue for validators that are waiting to become active validators is stored in the inactive validators subtree, and is keyed with <code>0</code> (i.e. <code>0x0000000000000000000000000000000000000000000000000000000000000000</code>), with the first byte replaced with <code>INACTIVE_VALIDATORS_SUBTREE_ID</code>.</p> <p>If the queue is empty, <code>head</code> is set to the default value (i.e. the hash of the leaf is <a href="#sparse-merkle-tree">the default value for a Sparse Merkle Tree</a>).</p> <h3 id="periodentry"><a href="#periodentry" class="header-anchor">#</a> PeriodEntry</h3> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>rewardRate</code></td> <td><a href="#type-aliases">Amount</a></td> <td>Rewards per unit of voting power accumulated so far, in <code>1u</code>.</td></tr></tbody></table> <p>For explanation on entries, see the <a href="/rationale/distributing_rewards.html">reward distribution rationale document</a>.</p> <h3 id="decimal"><a href="#decimal" class="header-anchor">#</a> Decimal</h3> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>numerator</code></td> <td>uint64</td> <td>Rational numerator.</td></tr> <tr><td><code>denominator</code></td> <td>uint64</td> <td>Rational denominator.</td></tr></tbody></table> <p>Represents a (potentially) non-integer number.</p> <h3 id="messagepaid"><a href="#messagepaid" class="header-anchor">#</a> MessagePaid</h3> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>start</code></td> <td><code>uint64</code></td> <td>Share index (in row-major order) of first share paid for (inclusive).</td></tr> <tr><td><code>finish</code></td> <td><code>uint64</code></td> <td>Share index (in row-major order) of last share paid for (inclusive).</td></tr> <tr><td><code>next</code></td> <td><a href="#hashdigest">HashDigest</a></td> <td>Next transaction ID in the list.</td></tr></tbody></table> <h3 id="messagepaidhead"><a href="#messagepaidhead" class="header-anchor">#</a> MessagePaidHead</h3> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>head</code></td> <td><a href="#hashdigest">HashDigest</a></td> <td>Transaction hash at the head of the list (has the smallest start index).</td></tr></tbody></table> <p>The head of the list of paid message shares is stored in the message share paid subtree, and is keyed with <code>0</code> (i.e. <code>0x0000000000000000000000000000000000000000000000000000000000000000</code>), with the first byte replaced with <code>MESSAGE_PAID_SUBTREE_ID</code>.</p> <p>If the paid list is empty, <code>head</code> is set to the default value (i.e. the hash of the leaf is <a href="#sparse-merkle-tree">the default value for a Sparse Merkle Tree</a>).</p> <h2 id="consensus-parameters"><a href="#consensus-parameters" class="header-anchor">#</a> Consensus Parameters</h2> <p>Various <a href="/specs/consensus.html#system-parameters">consensus parameters</a> are committed to in the block header, such a limits and constants.</p> <table><thead><tr><th>name</th> <th>type</th> <th>description</th></tr></thead> <tbody><tr><td><code>version</code></td> <td><a href="#consensusversion">ConsensusVersion</a></td> <td>The consensus version struct.</td></tr> <tr><td><code>chainID</code></td> <td><code>string</code></td> <td>The <code>CHAIN_ID</code>.</td></tr> <tr><td><code>shareSize</code></td> <td><code>uint64</code></td> <td>The <code>SHARE_SIZE</code>.</td></tr> <tr><td><code>shareReservedBytes</code></td> <td><code>uint64</code></td> <td>The <code>SHARE_RESERVED_BYTES</code>.</td></tr> <tr><td><code>availableDataOriginalSquareMax</code></td> <td><code>uint64</code></td> <td>The <code>AVAILABLE_DATA_ORIGINAL_SQUARE_MAX</code>.</td></tr></tbody></table> <p>In order to compute the <code>consensusHash</code> field in the <a href="#header">block header</a>, the above list of parameters is <a href="#hashing">hashed</a>.</p></div><!----></div></div></div></div><div class="layout__main__content__aside__container" style="--height-banners:nullpx;" data-v-58560e81><div class="layout__main__content__aside aside__bottom__false" data-v-58560e81><!----></div><div class="layout__main__content__aside__banners" data-v-58560e81><a href="https://github.com/celestiaorg/docs.celestia.org/issues" target="_blank" data-v-58560e81><div data-v-31935645 data-v-58560e81><div class="container" data-v-31935645><svg width="100%" height="100%" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" class="icon" data-v-31935645><path d="M0.836491 13.7697C0.543598 14.0626 0.543598 14.5374 0.836492 14.8303C1.12939 15.1232 1.60426 15.1232 1.89715 14.8303L0.836491 13.7697ZM14.7729 1.95457C15.0658 1.66168 15.0658 1.1868 14.7729 0.893912C14.48 0.601019 14.0051 0.601019 13.7122 0.893913L14.7729 1.95457ZM14.6668 1H15.4168V0.25H14.6668V1ZM4.48498 0.25C4.07077 0.25 3.73498 0.585786 3.73498 1C3.73498 1.41421 4.07077 1.75 4.48498 1.75V0.25ZM13.9168 11.1818C13.9168 11.596 14.2526 11.9318 14.6668 11.9318C15.081 11.9318 15.4168 11.596 15.4168 11.1818H13.9168ZM1.89715 14.8303L14.7729 1.95457L13.7122 0.893913L0.836491 13.7697L1.89715 14.8303ZM14.6668 0.25H4.48498V1.75H14.6668V0.25ZM15.4168 11.1818V1H13.9168V11.1818H15.4168Z"></path></svg><div class="image" data-v-31935645><svg width="41" height="44" viewBox="0 0 41 44" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-31935645><path fill-rule="evenodd" clip-rule="evenodd" d="M4 1.8999H32C33.3807 1.8999 34.5 3.01919 34.5 4.3999V10.997L36 9.497V4.3999C36 2.19076 34.2091 0.399902 32 0.399902H4C1.79086 0.399902 0 2.19077 0 4.39991V39.5999C0 41.809 1.79086 43.5999 4 43.5999H32C34.2091 43.5999 36 41.809 36 39.5999V20.2096L34.5 21.7096V39.5999C34.5 40.9806 33.3807 42.0999 32 42.0999H4C2.61929 42.0999 1.5 40.9806 1.5 39.5999V4.39991C1.5 3.01919 2.61929 1.8999 4 1.8999ZM7.2 19.1999H26.2971L24.2971 21.1999H7.2V19.1999ZM7.2 15.7999H28.8V13.7999H7.2V15.7999ZM7.2 26.5999H16.2V24.5999H7.2V26.5999ZM20.8638 25.7372L20.7386 25.8624L20.6826 26.0303L18.9855 31.1215L18.4792 32.6406L19.9704 32.0571L24.8494 30.1479L24.9955 30.0908L25.1064 29.9798L37.9799 17.1063L39.7831 15.3032C40.9546 14.1316 40.9546 12.2321 39.7831 11.0606C38.6115 9.88898 36.712 9.88898 35.5404 11.0606L20.8638 25.7372ZM20.9149 30.0767L22.0496 26.6726L36.6011 12.1212C37.1869 11.5354 38.1366 11.5354 38.7224 12.1212C39.3082 12.707 39.3082 13.6567 38.7224 14.2425L37.4496 15.5153L36.2465 14.3122C35.9536 14.0193 35.4787 14.0193 35.1858 14.3122C34.8929 14.6051 34.8929 15.08 35.1858 15.3729L36.3889 16.576L24.5761 28.3888L23.6215 27.4342C23.3286 27.1413 22.8537 27.1413 22.5608 27.4342C22.2679 27.7271 22.2679 28.202 22.5608 28.4949L23.2349 29.1689L20.9149 30.0767Z" fill="var(--color-primary, blue)" data-v-31935645></path></svg></div><div class="h1" data-v-31935645>Found an Issue?</div><div class="h2" data-v-31935645>Help us improve this page by suggesting edits on GitHub.</div></div></div></a></div></div></div><div class="layout__main__gutter" data-v-58560e81><div data-v-15325c0d data-v-58560e81><div class="links" data-v-15325c0d><div class="links__wrapper" data-v-15325c0d><div class="links__container" data-v-15325c0d><a href="/specs/architecture.html" class="links__item links__item__left" data-v-15325c0d><div class="links__item__icon" data-v-15325c0d><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 64 64" data-v-15325c0d><title data-v-15325c0d>arrow-right</title><g stroke-linecap="square" stroke-linejoin="miter" stroke-width="2" data-v-15325c0d><line fill="none" stroke-miterlimit="10" x1="61" y1="32" x2="3" y2="32" stroke-linecap="butt" data-v-15325c0d></line><polyline fill="none" stroke-miterlimit="10" points="21,14 3,32 21,50 " data-v-15325c0d></polyline></g></svg></div><div data-v-15325c0d><div class="links__label" data-v-15325c0d>Previous</div><div class="links__item__title" data-v-15325c0d>Architecture</div><!----></div></a></div></div><div class="links__wrapper" data-v-15325c0d><div class="links__container" data-v-15325c0d><a href="/specs/consensus.html" class="links__item links__item__right" data-v-15325c0d><div data-v-15325c0d><div class="links__label" data-v-15325c0d>Next</div><div class="links__item__title" data-v-15325c0d>Consensus Rules</div><!----></div><div class="links__item__icon" data-v-15325c0d><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 64 64" data-v-15325c0d><title data-v-15325c0d>arrow-right</title><g stroke-linecap="square" stroke-linejoin="miter" stroke-width="2" data-v-15325c0d><line fill="none" stroke-miterlimit="10" x1="3" y1="32" x2="61" y2="32" stroke-linecap="butt" data-v-15325c0d></line><polyline fill="none" stroke-miterlimit="10" points="43,14 61,32 43,50 " data-v-15325c0d></polyline></g></svg></div></a></div></div></div></div></div><div class="layout__main__footer" data-v-58560e81><div data-v-732a47ec data-v-58560e81><div class="wrapper" data-v-732a47ec><div class="container" data-v-732a47ec><div class="footer__wrapper" data-v-732a47ec><!----><!----><div class="logo" data-v-732a47ec><div class="logo__item" data-v-732a47ec><a href="https://celestia.org/" target="_blank" rel="noreferrer noopener" tag="div" class="logo__image" data-v-732a47ec><img src="/celestia-logo.png" data-v-732a47ec></a></div><div class="logo__item logo__link" data-v-732a47ec><a href="https://github.com/celestiaorg/" target="_blank" title="github" rel="noreferrer noopener" class="smallprint__item__links__item" data-v-732a47ec><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" fill="#aaa" data-v-732a47ec><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z" data-v-732a47ec></path></svg></a><a href="https://twitter.com/CelestiaOrg" target="_blank" title="twitter" rel="noreferrer noopener" class="smallprint__item__links__item" data-v-732a47ec><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" fill="#aaa" data-v-732a47ec><path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z" data-v-732a47ec></path></svg></a><a href="https://blog.celestia.org/" target="_blank" title="medium" rel="noreferrer noopener" class="smallprint__item__links__item" data-v-732a47ec><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" fill="#aaa" data-v-732a47ec><path d="M24 24h-24v-24h24v24zm-4.03-5.649v-.269l-1.247-1.224c-.11-.084-.165-.222-.142-.359v-8.998c-.023-.137.032-.275.142-.359l1.277-1.224v-.269h-4.422l-3.152 7.863-3.586-7.863h-4.638v.269l1.494 1.799c.146.133.221.327.201.523v7.072c.044.255-.037.516-.216.702l-1.681 2.038v.269h4.766v-.269l-1.681-2.038c-.181-.186-.266-.445-.232-.702v-6.116l4.183 9.125h.486l3.593-9.125v7.273c0 .194 0 .232-.127.359l-1.292 1.254v.269h6.274z" data-v-732a47ec></path></svg></a></div></div><div class="smallprint" data-v-732a47ec><div class="smallprint__item smallprint__item__links" data-v-732a47ec><!----></div><div class="smallprint__item__desc smallprint__item" data-v-732a47ec><div>This website is maintained by Celestia</div></div></div></div></div></div></div></div></div></div><div class="sheet__sidebar" data-v-ec82e5e0 data-v-58560e81><!----> <!----></div><div class="sheet__sidebar" data-v-ec82e5e0 data-v-58560e81><!----> <!----></div><div class="sheet__sidebar sheet__sidebar__toc" data-v-ec82e5e0 data-v-58560e81><!----> <!----></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.3019ee2f.js" defer></script><script src="/assets/js/24.9ee132fe.js" defer></script><script src="/assets/js/21.865da597.js" defer></script><script src="/assets/js/19.9237c15e.js" defer></script><script src="/assets/js/25.d7d7cb83.js" defer></script><script src="/assets/js/51.3dad154c.js" defer></script><script src="/assets/js/35.41cfeeaf.js" defer></script><script src="/assets/js/10.52df64e7.js" defer></script><script src="/assets/js/7.ab024a49.js" defer></script><script src="/assets/js/2.8fa296b0.js" defer></script><script src="/assets/js/3.99b12bb4.js" defer></script><script src="/assets/js/5.ba54e65b.js" defer></script><script src="/assets/js/33.bfc83eac.js" defer></script><script src="/assets/js/13.730058d7.js" defer></script><script src="/assets/js/12.87efa0ff.js" defer></script><script src="/assets/js/20.bbf83c6f.js" defer></script>
  </body>
</html>
